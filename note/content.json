{"meta":{"title":"Hexo","subtitle":null,"description":null,"author":"frank","url":"http://ye63.github.io/note"},"pages":[{"title":"tags","date":"2018-08-27T11:26:57.000Z","updated":"2018-08-27T12:18:09.849Z","comments":false,"path":"tags/index.html","permalink":"http://ye63.github.io/note/tags/index.html","excerpt":"","text":""},{"title":"categories","date":"2018-08-27T11:47:23.000Z","updated":"2018-08-27T12:18:09.847Z","comments":true,"path":"categories/index.html","permalink":"http://ye63.github.io/note/categories/index.html","excerpt":"","text":""}],"posts":[{"title":"React Js 微信分享封装","slug":"React-Js-微信分享封装","date":"2018-09-03T07:17:54.000Z","updated":"2018-09-03T07:23:09.990Z","comments":true,"path":"2018/09/03/React-Js-微信分享封装/","link":"","permalink":"http://ye63.github.io/note/2018/09/03/React-Js-微信分享封装/","excerpt":"","text":"123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116import Fetch from './FetchIt';import API_URL from './url';import Share from './Share';let wxUtils = &#123;&#125;;////////////////////////////////////////////////////////////////////////////////////////// 分享/////////////////////////////////////////////////////////////////////////////////////////** getshareinfo?type= type :goods 课程详情 team 团详情 id 课程id tid 团ID * @param config * @param shareInfo &#123;imgUrl,title,description,link&#125; */function share2wx(config, shareInfo) &#123; const share = new Share(&#123; appid: config.appid, // 必填，公众号的唯一标识 timestamp: config.timestamp, // 必填，生成签名的时间戳 nonceStr: config.nonceStr, // 必填，生成签名的随机串 signature: config.signature, // 必填，签名 &#125;); share.init(Object.assign(&#123;&#125;, shareInfo));&#125;function getConfig(shareInfo) &#123; let href = window.location.href.split('#')[0]; const url = encodeURIComponent(href /*window.location.href*/); Fetch.get(`$&#123;API_URL.mobile.signature_path&#125;?url=$&#123;url&#125;`).then(data =&gt; &#123; share2wx(data, shareInfo); &#125;);&#125;/** * @param shareInfo */wxUtils.share = function (shareInfo) &#123; getConfig(shareInfo);&#125;;////////////////////////////////////////////////////////////////////////////////////////// 分享结束/////////////////////////////////////////////////////////////////////////////////////////** * 是否开启右上角Menu * @param open */wxUtils.optionMenu = function (open = true) &#123; if (open) &#123; openOptionMenu(); &#125; else &#123; disabledOptionMenu(); &#125;&#125;;/** * 是否禁用右上角 */function disabledOptionMenu() &#123; if (typeof WeixinJSBridge === \"undefined\") &#123; if (document.addEventListener) &#123; document.addEventListener('WeixinJSBridgeReady', onBridgeReady(true), false); &#125; else if (document.attachEvent) &#123; document.attachEvent('WeixinJSBridgeReady', onBridgeReady(true)); document.attachEvent('onWeixinJSBridgeReady', onBridgeReady(true)); &#125; &#125; else &#123; onBridgeReady(true); &#125;&#125;/** * 开启menu */function openOptionMenu() &#123; if (typeof WeixinJSBridge === \"undefined\") &#123; if (document.addEventListener) &#123; document.addEventListener('WeixinJSBridgeReady', onBridgeReady(false), false); &#125; else if (document.attachEvent) &#123; document.attachEvent('WeixinJSBridgeReady', onBridgeReady(false)); document.attachEvent('onWeixinJSBridgeReady', onBridgeReady(false)); &#125; &#125; else &#123; onBridgeReady(false); &#125;&#125;function onBridgeReady(disable = true) &#123; if (typeof WeixinJSBridge !== \"undefined\") WeixinJSBridge.call(disable ? 'hideOptionMenu' : 'showOptionMenu');&#125;/** * 隐藏微信网页底部的导航栏 * @param disable */wxUtils.disabledToolbar = function (disable = true) &#123; document.addEventListener('WeixinJSBridgeReady', function onBridgeReady() &#123; // 通过下面这个API隐藏底部导航栏 WeixinJSBridge.call(disable ? 'hideToolbar' : 'showToolbar'); &#125;);&#125;;export default wxUtils; 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061// 分享function Share(config) &#123; wx.config(&#123; debug: false, // 开启调试模式 appId: config.appid, // 必填，公众号的唯一标识 timestamp: config.timestamp, // 必填，生成签名的时间戳 nonceStr: config.nonceStr, // 必填，生成签名的随机串 signature: config.signature, // 必填，签名，见附录1 jsApiList: ['onMenuShareTimeline', 'onMenuShareAppMessage', 'onMenuShareWeibo'], // 必填，需要使用的JS接口列表，所有JS接口列表见附录2 &#125;);&#125;Share.prototype = &#123; constructor: Share, init(config) &#123; this.imgUrl = config.imgUrl; this.link = config.link; // this.musicPath = config.musicPath; this.description = config.description; this.title = config.title; wx.ready(() =&gt; &#123; // if (this.musicPath) &#123; // document.getElementById('musicIcon').play(); // &#125; this.toFriend(); this.toTimeline(); &#125;); wx.error(res =&gt; &#123; console.log(`$&#123;res&#125;`); &#125;); &#125;, toFriend() &#123; wx.onMenuShareAppMessage(&#123; imgUrl: this.imgUrl, link: this.link, title: this.title, desc: this.description, success: function () &#123; // 用户确认分享后执行的回调函数 &#125;, &#125;); &#125;, toTimeline() &#123; wx.onMenuShareTimeline(&#123; imgUrl: this.imgUrl, link: this.link, title: this.title, desc: this.description, success: function () &#123; // 用户确认分享后执行的回调函数 &#125;, &#125;); &#125;,&#125;;export default Share; 12345678//开启分享BaseComponent.wxUtils.optionMenu(true);BaseComponent.wxUtils.share(&#123; imgUrl: activityData.sharePicUrl, title: activityData.shareTitle, description: activityData.shareContent, link: url,&#125;);","categories":[],"tags":[{"name":"React","slug":"React","permalink":"http://ye63.github.io/note/tags/React/"}]},{"title":"article title","slug":"article-title","date":"2018-08-27T12:55:27.000Z","updated":"2018-08-27T12:57:02.795Z","comments":true,"path":"2018/08/27/article-title/","link":"","permalink":"http://ye63.github.io/note/2018/08/27/article-title/","excerpt":"","text":"1、兄弟之间传递数据需要借助于事件车，通过事件车的方式传递数据 2、创建一个Vue的实例，让各个兄弟共用同一个事件机制。 3、传递数据方，通过一个事件触发bus.$emit(方法名，传递的数据)。 4、接收数据方，通过mounted(){}触发bus.$on(方法名，function(接收数据的参数){用该组件的数据接收传递过来的数据})，此时函数中的this已经发生了改变，可以使用箭头函数。 源码： 我们可以创建一个单独的js文件eventVue.js,内容如下12import Vue from 'vue'export default new Vue 假如父组件如下：1234&lt;template&gt; &lt;components-a&gt;&lt;/components-a&gt; &lt;components-b&gt;&lt;/components-b&gt;&lt;/template&gt; 组件a12345678910111213141516&lt;template&gt; &lt;div class=&quot;components-a&quot;&gt; &lt;button @click=&quot;abtn&quot;&gt;A按钮&lt;/button&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;import eventVue from &apos;../../js/event.js&apos;export default &#123; ... methods:&#123; abtn:function()&#123; eventVue .$emit(&quot;myFun&quot;,&quot;组件A的值&quot;) //$emit这个方法会触发一个事件 &#125; &#125;&#125;&lt;/script&gt; 组件b123456789101112131415161718192021&lt;template&gt; &lt;div class=&quot;components-a&quot;&gt; &lt;div&gt;&#123;&#123;btext&#125;&#125;&lt;/div&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;import eventVue from &apos;../../js/event.js&apos;export default &#123; .... created:function()&#123; this.bbtn(); &#125;, methods:&#123; bbtn:function()&#123; eventVue .$on(&quot;myFun&quot;,(message)=&gt;&#123; //这里最好用箭头函数，不然this指向有问题 this.btext = message &#125;) &#125; &#125;&#125;&lt;/script&gt;","categories":[],"tags":[{"name":"vue","slug":"vue","permalink":"http://ye63.github.io/note/tags/vue/"}]},{"title":"Hello World","slug":"hello-world","date":"2018-08-27T12:18:09.824Z","updated":"2018-08-27T12:18:09.824Z","comments":true,"path":"2018/08/27/hello-world/","link":"","permalink":"http://ye63.github.io/note/2018/08/27/hello-world/","excerpt":"","text":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new \"My New Post\" More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment","categories":[],"tags":[]}]}