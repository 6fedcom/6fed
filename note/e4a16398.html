<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
    

    

    
<!-- Baidu Tongji -->
<script>var _hmt = _hmt || []</script>
<script async src="//hm.baidu.com/hm.js?38be42ece57751ae5fcd54ba1c669508"></script>
<!-- End Baidu Tongji -->




    <meta charset="utf-8">
    
    
    
    <link rel="canonical" href="https://ru23.com/note/e4a16398.html">
    
    
    <title>How to resolve iOS 11 Safari getUserMedia “Invalid constraint” issue | 前端迷 (front-end fan) | frank，前端开发爱好者，沉迷前端，无法自拔,欢迎一切技术交流（不局限于前端），邮箱fanqianweb@gmail.com</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#006fbc">
    
    
    <meta name="keywords" content="踩过的坑">
    <meta name="description" content="I’m attempting to run the following code in Safari in iOS 11. It should prompt the user to give access to their devices camera and then display it in my  element. However, when running in iOS 11, it r">
<meta name="keywords" content="踩过的坑">
<meta property="og:type" content="article">
<meta property="og:title" content="How to resolve iOS 11 Safari getUserMedia “Invalid constraint” issue">
<meta property="og:url" content="https://ru23.com/note/e4a16398.html">
<meta property="og:site_name" content="前端迷 (front-end fan)">
<meta property="og:description" content="I’m attempting to run the following code in Safari in iOS 11. It should prompt the user to give access to their devices camera and then display it in my  element. However, when running in iOS 11, it r">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2018-11-28T05:33:05.990Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="How to resolve iOS 11 Safari getUserMedia “Invalid constraint” issue">
<meta name="twitter:description" content="I’m attempting to run the following code in Safari in iOS 11. It should prompt the user to give access to their devices camera and then display it in my  element. However, when running in iOS 11, it r">
    
        <link rel="alternate" type="application/atom+xml" title="前端迷 (front-end fan)" href="/atom.xml">
    
    <link rel="shortcut icon" href="/img/blue.ico">
    <link rel="stylesheet" href="/css/style.css?v=1.7.2">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

</head>

<body>
    <div id="loading" class="active"></div>


    <aside id="menu">
    <div class="inner flex-row-vertical">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
            <i class="icon icon-lg icon-close"></i>
        </a>
        <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
            <div class="brand">
                <a href="/" class="avatar waves-effect waves-circle waves-light">
                    <img src="/img/avatar.gif">
                </a>
                <hgroup class="introduce">
                    <h5 class="nickname">
                        frank
                    </h5>
                    <a href="mailto:188105274@qq.com" title="188105274@qq.com" class="mail">188105274@qq.com</a>
                </hgroup>
            </div>
        </div>
        <div class="scroll-wrap flex-col">
            <!-- <a target="_blank" class="ad_left" href="https://promotion.aliyun.com/ntms/yunparter/invite.html?userCode=jh5fwy2j">
                <img src="/img/ad/201810/300×90.jpg" alt="/双11红包来啦">
            </a> -->
            <ul class="nav">
                
                <li class="waves-block waves-effect">
                    <a href="/">
                        <i class="icon icon-lg icon-home"></i>
                        主页
                    </a>
                </li>
                
                <li class="waves-block waves-effect">
                    <a href="/tags">
                        <i class="icon icon-lg icon-tags"></i>
                        标签
                    </a>
                </li>
                
                <li class="waves-block waves-effect">
                    <a href="/categories">
                        <i class="icon icon-lg icon-th-list"></i>
                        目录
                    </a>
                </li>
                
                <li class="waves-block waves-effect">
                    <a href="/archives">
                        <i class="icon icon-lg icon-archives"></i>
                        归档
                    </a>
                </li>
                

                <!-- <li class="ad-qrcode">
                    <img src="/img/ad/201810/ad-left.jpg">
                </li> -->
                <li class="ad-qrcode">
                    <img src="https://user-images.githubusercontent.com/22697565/47767553-1d435500-dd0f-11e8-99ea-63cc43444e5c.jpg">
                </li>


            </ul>

        </div>
    </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
            <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">
            How to resolve iOS 11 Safari getUserMedia “Invalid constraint” issue
        </div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="输入感兴趣的关键字">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">
    <div class="container fade-scale">
        <h1 class="title">
            How to resolve iOS 11 Safari getUserMedia “Invalid constraint” issue
        </h1>
        <h5 class="subtitle">
            
            <time datetime="2018-11-26T05:01:05.000Z" itemprop="datePublished" class="page-time">
  2018-11-26
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/front-end/">front-end</a></li></ul>

            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
<aside class="post-widget">
    <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
        <h4>TOC</h4>
        <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Answer"><span class="post-toc-text">Answer</span></a></li></ol>
    </nav>
</aside>



<article id="post-2018-11-How-to-resolve-iOS-11-Safari-getUserMedia-“Invalid-constraint”-issue" class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">How to resolve iOS 11 Safari getUserMedia “Invalid constraint” issue</h1>
        <div class="post-meta">
            <time class="post-time" id="post-time" title="2018-11-26 13:01:05" datetime="2018-11-26T05:01:05.000Z" itemprop="datePublished">2018-11-26</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/front-end/">front-end</a></li></ul>



            
<span id="busuanzi_container_page_pv" title="文章总阅读量" style="display:none">
    <i class="icon icon-eye icon-pr"></i><span id="random"></span><span id="busuanzi_value_page_pv"></span>
</span>


        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <p>I’m attempting to run the following code in Safari in iOS 11. It should prompt the user to give access to their devices camera and then display it in my <video autoplay id="video"></video> element. However, when running in iOS 11, it results in an OverconstrainedError to be thrown:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">message</span>: <span class="string">"Invalid constraint"</span>, <span class="attr">constraint</span>: <span class="string">"width"</span>&#125;</span><br></pre></td></tr></table></figure></p>
<p>The code runs fine in Chorme and successfully opens the camera.<br>I’ve attempted multiple valid configurations with no luck.</p>
<p><strong>Code</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> video = <span class="built_in">document</span>.getElementById(<span class="string">'video'</span>);</span><br><span class="line"><span class="keyword">if</span>(navigator.mediaDevices &amp;&amp; navigator.mediaDevices.getUserMedia) &#123;</span><br><span class="line">     navigator.mediaDevices.getUserMedia(&#123;<span class="attr">video</span>: <span class="literal">true</span>&#125;)</span><br><span class="line">         .then(<span class="function"><span class="keyword">function</span>(<span class="params">stream</span>) </span>&#123;</span><br><span class="line">             video.src = <span class="built_in">window</span>.URL.createObjectURL(stream);</span><br><span class="line">             video.play();</span><br><span class="line">         &#125;)</span><br><span class="line">         .catch(<span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>&#123;</span><br><span class="line">             <span class="built_in">console</span>.log(err);</span><br><span class="line">         &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="Answer"><a href="#Answer" class="headerlink" title="Answer"></a>Answer</h2><p>The invalid constraint error in safari is because the browser expects that you pass a correct width, one of:</p>
<ul>
<li>320</li>
<li>640</li>
<li><p>1280<br>the height is auto calculate in an aspect ratio of 4:3 for 320 or 640, and 16:9 for 1280, then if you pass a width of 320, you video stream is set in:</p>
</li>
<li><p>320x240<br>if you set a width of 640, you video stream is set in:</p>
</li>
<li><p>640x480<br>And if you set a width of 1280, then you video stream is set in:</p>
</li>
<li><p>1280x720<br>In any other case you got a error “InvalidConstrain” for width value.</p>
</li>
</ul>
<p>Also you can use a min, max, exact or ideal constrains for width, please check the MDN documentation</p>
<p>Here an example in this codepen<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> config = &#123; <span class="attr">video</span>: &#123; <span class="attr">width</span>: <span class="number">320</span><span class="comment">/*320-640-1280*/</span> &#125; &#125;;</span><br><span class="line"><span class="keyword">var</span> start = <span class="function"><span class="params">()</span> =&gt;</span> navigator.mediaDevices.getUserMedia(config)</span><br><span class="line">  .then(<span class="function"><span class="params">stream</span> =&gt;</span> v.srcObject = stream)</span><br><span class="line">  .then(<span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> v.onloadedmetadata = resolve))</span><br><span class="line">  .then(<span class="function"><span class="params">()</span> =&gt;</span> log(<span class="string">"Success: "</span> + v.videoWidth + <span class="string">"x"</span> + v.videoHeight))</span><br><span class="line">  .catch(log);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> log = <span class="function"><span class="params">msg</span> =&gt;</span> div.innerHTML += <span class="string">"&lt;p&gt;"</span> + msg + <span class="string">"&lt;/p&gt;"</span>;</span><br></pre></td></tr></table></figure></p>
<p>PD: In chrome you can set a width of height and the video stream is set in these sizes, Firefox do a fitness distance, and Safari expect a exact match.</p>

        </div>

        <blockquote class="post-copyright">
    
    <div class="content">
        
<span class="post-time">
    <div class="qrcode-container">
        <img src="/img/qrcode.png">
    </div><br>
</span><br>


        
        【前端迷】微信公众号是一个公益性的前端技术分享平台，可以为广大前端开发者们带来最新的技术资讯，欢迎大家订阅。
        
    </div>
    
    <footer>
        <a href="https://ru23.com">
            <img src="/img/avatar.gif" alt="frank">
            frank
        </a>
    </footer>
</blockquote>

<div class="ad-art-end">
    <a href="https://promotion.aliyun.com/ntms/act/qwbk.html?userCode=jh5fwy2j" target="_blank">
        <img src="/img/ad/201810/alierzhe.png" alt="全民云计算 云主机低至2折">
    </a>
</div>

        


        <div class="post-footer">
            
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/踩过的坑/">踩过的坑</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://ru23.com/note/e4a16398.html&title=《How to resolve iOS 11 Safari getUserMedia “Invalid constraint” issue》 — 前端迷 (front-end fan)&pic=https://ru23.com/img/avatar.gif" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://ru23.com/note/e4a16398.html&title=《How to resolve iOS 11 Safari getUserMedia “Invalid constraint” issue》 — 前端迷 (front-end fan)&source=frank，前端开发爱好者，沉迷前端，无法自拔,欢迎一切技术交流（不局限于前端），邮箱fanqianweb@gmail.com" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://ru23.com/note/e4a16398.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《How to resolve iOS 11 Safari getUserMedia “Invalid constraint” issue》 — 前端迷 (front-end fan)&url=https://ru23.com/note/e4a16398.html&via=https://ru23.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://ru23.com/note/e4a16398.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/note/368be592.html" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">简书笔记摘抄</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/note/f4c4f07f.html" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">算法题</h4>
      </a>
    </div>
  
</nav>



    











    <!-- Valine Comments -->
    <div class="comments vcomment" id="comments"></div>
    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
    <script src="//unpkg.com/valine@latest/dist/Valine.min.js"></script>
    <!-- Valine Comments script -->
    <script>
        var GUEST_INFO = ['nick','mail','link'];
        var guest_info = 'nick,mail,link'.split(',').filter(function(item){
          return GUEST_INFO.indexOf(item) > -1
        });
        new Valine({
            el: '#comments',
            notify: 'false' == 'true',
            verify: 'false' == 'true',
            appId: "OOiJvCREqswvpnTL4RuSShLq-gzGzoHsz",
            appKey: "OPfVBB2YjMrT3ngcc8mu6w8g",
            avatar: "mm",
            qrcode: "",
            placeholder: "Just go go",
            guest_info: guest_info.length == 0 ? GUEST_INFO : guest_info,
            pageSize: "10"
        })
    </script>
    <!-- Valine Comments end -->







</article>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style="display:none">
        <span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style="display:none">
        <span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            
            <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>
                博客内容遵循 <a rel="license" href="javascript:;">知识共享 署名 - 非商业性 - 相同方式共享 4.0 国际协议</a></span>
        </p>
    </div>
    <div class="bottom">
        <p><span>
                frank &copy;
                
                2015 -
                
                2018</span>
            <span>
                
                <a href="http://www.miitbeian.gov.cn/" target="_blank">
                    晋ICP备18012373号</a><br>
                
                Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a target="_blank">indigo</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://ru23.com/note/e4a16398.html&title=《How to resolve iOS 11 Safari getUserMedia “Invalid constraint” issue》 — 前端迷 (front-end fan)&pic=https://ru23.com/img/avatar.gif" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://ru23.com/note/e4a16398.html&title=《How to resolve iOS 11 Safari getUserMedia “Invalid constraint” issue》 — 前端迷 (front-end fan)&source=frank，前端开发爱好者，沉迷前端，无法自拔,欢迎一切技术交流（不局限于前端），邮箱fanqianweb@gmail.com" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://ru23.com/note/e4a16398.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《How to resolve iOS 11 Safari getUserMedia “Invalid constraint” issue》 — 前端迷 (front-end fan)&url=https://ru23.com/note/e4a16398.html&via=https://ru23.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://ru23.com/note/e4a16398.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAK4AAACuCAAAAACKZ2kyAAABy0lEQVR42u3aSW7DMAwF0Nz/0i6QVYvC6ic1xAWeVoGS2M9eEBz0esXreq/fO9/Xqn8tWLi4uNPca7jubjzeH+PGO388Ei4u7kHumJJceuYVFF4HLi7uw7jJTi9twsXF/b/cPH3Jr4CLi/tkbpKO5CXK+PHytAkXF/dT3Jl0ZNXnjf1dXFzcIvdqraQ5Uk2Povvi4uIe4d4lHzPD12qpU26v4OLibuauGnjkBU81CP7YwcXFPcKtHpjIf98ropKBDS4u7m5u9chUNRj1rnz7LS4u7kFuddSR36w6VokaIri4uJu58w2LfOBaLXimsiRcXNxF3Gqpkxc/eVEUSXBxcTdzq4lIr1XaS55wcXE/y+01PauDk3xmehvacHFxj3DzEqjXKOkFyuiBcXFxj3B7ZU+vj5GEqiiw4uLiHuHmF6oORcqI6jvGxcXdzK1OMXrD1+p9cXFxz3Cv4qqmPjONj0IXBxcXdyl3PvJVE6CkEYOLi/sEbvXgVN4Y7YGiQxi4uLhHuHmgGUfBmdbqgvEJLi7uA7gJPQlbSbGEi4v7TG5SOSXlUPOwBS4u7nHuquHozNi1cIIMFxd3M7dXiuSjl7y9srG/i4uLm3K/ALmovlVzT9Z8AAAAAElFTkSuQmCC" alt="微信分享二维码">
</div>




    <script src="//cdnjs.cloudflare.com/ajax/libs/node-waves/0.7.4/waves.min.js"></script>
<script>
    var BLOG = {
        ROOT: '/',
        SHARE: true,
        REWARD: false
    };

    
    lazyScripts.push('//s95.cnzz.com/z_stat.php?id=1275440747&web_id=1275440747')
    

</script>

<script src="/js/main.min.js?v=1.7.2"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="/js/search.min.js?v=1.7.2" async></script>






<!-- <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script> -->
<!-- <script>
    setTimeout(function () {
        var postTime = new Date(document.getElementById("post-time").innerHTML).getTime();
        var nowTime = new Date().getTime();
        
        if ((nowTime - postTime) < 24 * 3 * 3600 * 1000) {
            // document.getElementById("random").innerHTML = 1;
        } else {
            var viewCount = window.location.pathname.match(/\d+(\ \d+)?/)[0];
            document.getElementById("random").innerHTML = viewCount[0];
        }
    }, 0)

</script> -->
<!-- <script type="text/javascript" class="autoinsert" src="https://ru23.com/cdn/jquery-1.2.6.min.js"></script>
<script src="https://ru23.com/cdn/snowfall.jquery.min.js"></script>
<script>
    $(document).snowfall('clear');
    $("#random").html(Math.floor(Math.random() * (1 - 10) + 10))
    $(document).snowfall({
        image: "/img/huaban.png",
        flakeCount: 30,
        minSize: 5,
        maxSize: 22
    });
</script> -->





</body>
</html>
