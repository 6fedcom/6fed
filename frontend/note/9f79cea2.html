<!DOCTYPE html><html><head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="utf-8">
    
    <title>
       揭秘webpack插件工作流程和原理 |  前端迷
    </title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="keywords" content="前端迷,前端开发,前端知识大全,前端优化,前端导航,小程序,ru23.com,JavaScript,ajax,angular,css,webpack,react,gulp,htmlhtml5,mocha,nginx,node,css3,vue,vue-cli,scss">
     <meta name="description" content="前言通过插件我们可以扩展webpack，在合适的时机通过Webpack提供的 API 改变输出结果，使webpack可以执行更广泛的任务，拥有更强的构建能力。本文将尝试探索 webpack 插件的工作流程，进而去揭秘它的工作原理。同时需要你对webpack底层和构建流程的一些东西有一定的了解。 想要了解 webpack 的插件的机制，需要弄明白以下几个知识点：  一个简单的插件的构成 webpac">
<meta name="keywords" content="webpack">
<meta property="og:type" content="article">
<meta property="og:title" content="揭秘webpack插件工作流程和原理">
<meta property="og:url" content="https://ru23.com/note/9f79cea2.html">
<meta property="og:site_name" content="前端迷">
<meta property="og:description" content="前言通过插件我们可以扩展webpack，在合适的时机通过Webpack提供的 API 改变输出结果，使webpack可以执行更广泛的任务，拥有更强的构建能力。本文将尝试探索 webpack 插件的工作流程，进而去揭秘它的工作原理。同时需要你对webpack底层和构建流程的一些东西有一定的了解。 想要了解 webpack 的插件的机制，需要弄明白以下几个知识点：  一个简单的插件的构成 webpac">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://cdn.6fed.com/github/webpack/plugin/how_webpack_compile.jpg">
<meta property="og:image" content="https://cdn.6fed.com/github/webpack/plugin/tapable.jpg">
<meta property="og:image" content="https://cdn.6fed.com/github/webpack/plugin/Compiler.jpg">
<meta property="og:image" content="https://cdn.6fed.com/github/webpack/plugin/compilation.jpg">
<meta property="og:image" content="https://cdn.6fed.com/github/webpack/plugin/inspect.jpg">
<meta property="og:image" content="https://cdn.6fed.com/github/webpack/plugin/debugger.jpg">
<meta property="og:updated_time" content="2020-05-18T16:43:30.323Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="揭秘webpack插件工作流程和原理">
<meta name="twitter:description" content="前言通过插件我们可以扩展webpack，在合适的时机通过Webpack提供的 API 改变输出结果，使webpack可以执行更广泛的任务，拥有更强的构建能力。本文将尝试探索 webpack 插件的工作流程，进而去揭秘它的工作原理。同时需要你对webpack底层和构建流程的一些东西有一定的了解。 想要了解 webpack 的插件的机制，需要弄明白以下几个知识点：  一个简单的插件的构成 webpac">
<meta name="twitter:image" content="https://cdn.6fed.com/github/webpack/plugin/how_webpack_compile.jpg">  
    <link rel="icon" href="//cdn.ru23.com/img/favicon.ico">
    
    <link href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="/css/style.css"> <script src="//cdn.ru23.com/js/pace.min.js"></script> 
  
  </head><body><div style="display: none;">
    <script src="//s22.cnzz.com/z_stat.php?id=1275440747&web_id=1275440747" language="JavaScript"></script>
  </div>


  




  <div id="container">
    <header id="header">
    <div id="banner"></div>
    <div id="header-outer">
        <div id="header-menu" class="header-menu-pos animated">
            <div class="header-menu-container">
                <a href="/" class="left">
                    <span class="site-title">前端迷</span>
                </a>
                <nav id="header-menu-nav" class="right">
                    
                    <a target="_blank" href="https://58fe.com">
                        <i class="fa fa-heart"></i>
                        <span>前端社区</span>
                    </a>
                    
                    <a href="/">
                        <i class="fa fa-home"></i>
                        <span>主页</span>
                    </a>
                    
                    <a href="/archives">
                        <i class="fa fa-archive"></i>
                        <span>归档</span>
                    </a>
                    
                </nav>
                <a class="mobile-header-menu-button">
                    <i class="fa fa-bars"></i>
                </a>
            </div>
        </div>
        <div id="header-row">
            <div id="logo">
                <a href="/">
                    <img src="//cdn.ru23.com/img/images/chrome.png" alt="logo">
                </a>
            </div>
            <div class="header-info">
                <div id="header-title">
                    
                    <h2>
                        前端迷
                    </h2>
                    
                </div>
                <div id="header-description">
                    
                    <h3>
                        凡事预则立，不预则废
                    </h3>
                    
                </div>
            </div>
            <nav class="header-nav">
                <div class="social">
                    
                        <a title="公众号" target="_blank" href="https://mp.weixin.qq.com/s/K3yG4eyuQvZxXIU9jas8kA">
                          <img src="//cdn.ru23.com/icon/mp.png" alt="logo">
                          </a>
                    
                        <a title="掘金" target="_blank" href="https://juejin.im/user/57fb24cf816dfa0056c1f8af">
                          <img src="//cdn.ru23.com/icon/juejin.png" alt="logo">
                          </a>
                    
                        <a title="Github" target="_blank" href="//github.com/ru23">
                          <img src="//cdn.ru23.com/icon/github.png" alt="logo">
                          </a>
                    
                        <a title="知乎" target="_blank" href="https://www.zhihu.com/people/58fe/activities">
                          <img src="//cdn.ru23.com/icon/zhihu.png" alt="logo">
                          </a>
                    
                </div>
            </nav>
        </div>
    </div>
</header>
    <div class="outer">
      <div class="outer-section">
        <section id="main" class="body-wrap"><article id="post-2020-05-plugin" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        <header class="article-header">
            
  
    <h1 class="post-title" itemprop="name">
      揭秘webpack插件工作流程和原理
    </h1>
    <div class="post-title-bar">
      <ul>
          
              <li>
                  <i class="fa fa-book"></i>
                  
                      <a href="/categories/front-end/">front-end</a>
                  
              </li>
          
        <li>
          <i class="fa fa-calendar"></i>  2020-05-06
        </li>
        <li>
          <i class="fa fa-eye"></i>
          <span id="busuanzi_value_page_pv"></span>
        </li>
      </ul>
    </div>
  

            
        </header>
        
        <div class="article-entry post-content" itemprop="articleBody">
            
            
            <meta name="generator" content="Hexo 3.8.0"><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>通过插件我们可以扩展<code>webpack</code>，在合适的时机通过<code>Webpack</code>提供的 API 改变输出结果，使<code>webpack</code>可以执行更广泛的任务，拥有更强的构建能力。<br>本文将尝试探索 <code>webpack</code> 插件的工作流程，进而去揭秘它的工作原理。同时需要你对<code>webpack</code>底层和构建流程的一些东西有一定的了解。</p>
<p>想要了解 webpack 的插件的机制，需要弄明白以下几个知识点：</p>
<ol>
<li>一个简单的插件的构成</li>
<li><code>webpack</code>构建流程</li>
<li><code>Tapable</code>是如何把各个插件串联到一起的</li>
<li><code>compiler</code>以及<code>compilation</code>对象的使用以及它们对应的事件钩子。</li>
</ol>
<h2 id="插件基本结构"><a href="#插件基本结构" class="headerlink" title="插件基本结构"></a>插件基本结构</h2><p><code>plugins</code>是可以用自身原型方法<code>apply</code>来实例化的对象。<code>apply</code>只在安装插件被<code>Webpack compiler</code>执行一次。<code>apply</code>方法传入一个<code>webpck compiler</code>的引用，来访问编译器回调。</p>
<h4 id="一个简单的插件结构："><a href="#一个简单的插件结构：" class="headerlink" title="一个简单的插件结构："></a>一个简单的插件结构：</h4><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HelloPlugin</span></span>{</span><br><span class="line">  <span class="comment">// 在构造函数中获取用户给该插件传入的配置</span></span><br><span class="line">  <span class="keyword">constructor</span>(options){</span><br><span class="line">  }</span><br><span class="line">  <span class="comment">// Webpack 会调用 HelloPlugin 实例的 apply 方法给插件实例传入 compiler 对象</span></span><br><span class="line">  apply(compiler) {</span><br><span class="line">    <span class="comment">// 在emit阶段插入钩子函数，用于特定时机处理额外的逻辑；</span></span><br><span class="line">    compiler.hooks.emit.tap(<span class="string">'HelloPlugin'</span>, (compilation) => {</span><br><span class="line">      <span class="comment">// 在功能流程完成后可以调用 webpack 提供的回调函数；</span></span><br><span class="line">    });</span><br><span class="line">    <span class="comment">// 如果事件是异步的，会带两个参数，第二个参数为回调函数，在插件处理完任务时需要调用回调函数通知webpack，才会进入下一个处理流程。</span></span><br><span class="line">    compiler.plugin(<span class="string">'emit'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">compilation, callback</span>) </span>{</span><br><span class="line">      <span class="comment">// 支持处理逻辑</span></span><br><span class="line">      <span class="comment">// 处理完毕后执行 callback 以通知 Webpack </span></span><br><span class="line">      <span class="comment">// 如果不执行 callback，运行流程将会一直卡在这不往下执行 </span></span><br><span class="line">      callback();</span><br><span class="line">    });</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = HelloPlugin;</span><br></pre></td></tr></tbody></table></figure>
<p>安装插件时, 只需要将它的一个实例放到<code>Webpack config plugins</code> 数组里面:<br></p><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> HelloPlugin = <span class="built_in">require</span>(<span class="string">'./hello-plugin.js'</span>);</span><br><span class="line"><span class="keyword">var</span> webpackConfig = {</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> HelloPlugin({<span class="attr">options</span>: <span class="literal">true</span>})</span><br><span class="line">  ]</span><br><span class="line">};</span><br></pre></td></tr></tbody></table></figure><p></p>
<p><strong>先来分析一下webpack Plugin的工作原理</strong></p>
<ol>
<li>读取配置的过程中会先执行 <code>new HelloPlugin(options)</code> 初始化一个 <code>HelloPlugin</code> 获得其实例。</li>
<li>初始化 <code>compiler</code> 对象后调用 <code>HelloPlugin.apply(compiler)</code> 给插件实例传入 <code>compiler</code> 对象。</li>
<li>插件实例在获取到 <code>compiler</code> 对象后，就可以通过<code>compiler.plugin(事件名称, 回调函数)</code> 监听到 Webpack 广播出来的事件。<br>并且可以通过 <code>compiler</code> 对象去操作 <code>Webpack</code>。</li>
</ol>
<h2 id="webapck-构建流程"><a href="#webapck-构建流程" class="headerlink" title="webapck 构建流程"></a>webapck 构建流程</h2><p>在编写插件之前，还需要了解一下<code>Webpack</code>的构建流程，以便在合适的时机插入合适的插件逻辑。</p>
<p>Webpack的基本构建流程如下：</p>
<ol>
<li>校验配置文件 ：读取命令行传入或者<code>webpack.config.js</code>文件，初始化本次构建的配置参数</li>
<li>生成<code>Compiler</code>对象：执行配置文件中的插件实例化语句<code>new MyWebpackPlugin()</code>，为<code>webpack</code>事件流挂上自定义<code>hooks</code></li>
<li>进入<code>entryOption</code>阶段：<code>webpack</code>开始读取配置的<code>Entries</code>，递归遍历所有的入口文件</li>
<li><code>run/watch</code>：如果运行在<code>watch</code>模式则执行<code>watch</code>方法，否则执行<code>run</code>方法</li>
<li><code>compilation</code>：创建<code>Compilation</code>对象回调<code>compilation</code>相关钩子，依次进入每一个入口文件(<code>entry</code>)，使用loader对文件进行编译。通过<code>compilation</code>我可以可以读取到<code>module</code>的<code>resource</code>（资源路径）、<code>loaders</code>（使用的loader）等信息。再将编译好的文件内容使用<code>acorn</code>解析生成AST静态语法树。然后递归、重复的执行这个过程，<br>所有模块和和依赖分析完成后，执行 <code>compilation</code> 的 <code>seal</code> 方法对每个 chunk 进行整理、优化、封装<code>__webpack_require__</code>来模拟模块化操作.</li>
<li><p><code>emit</code>：所有文件的编译及转化都已经完成，包含了最终输出的资源，我们可以在传入事件回调的<code>compilation.assets</code>上拿到所需数据，其中包括即将输出的资源、代码块Chunk等等信息。</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 修改或添加资源</span></span><br><span class="line">compilation.assets[<span class="string">'new-file.js'</span>] = {</span><br><span class="line">  source() {</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'var a=1'</span>;</span><br><span class="line">  },</span><br><span class="line">  size() {</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.source().length;</span><br><span class="line">  }</span><br><span class="line">};</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p><code>afterEmit</code>：文件已经写入磁盘完成</p>
</li>
<li><code>done</code>：完成编译<br><strong>奉上一张滴滴云博客的 WebPack 编译流程图,不喜欢看文字讲解的可以看流程图理解记忆</strong><br><img src="https://cdn.6fed.com/github/webpack/plugin/how_webpack_compile.jpg" alt="WebPack 编译流程图"></li>
</ol>
<p>原图出自：<a href="https://blog.didiyun.com/index.php/2019/03/01/webpack/" target="_blank" rel="noopener">https://blog.didiyun.com/index.php/2019/03/01/webpack/</a></p>
<p>看完之后，如果还是看不懂或者对缕不清webpack构建流程的话，建议通读一下全文，再回来看这段话，相信一定会对webpack构建流程有很更加深刻的理解。</p>
<h2 id="理解事件流机制-tapable"><a href="#理解事件流机制-tapable" class="headerlink" title="理解事件流机制 tapable"></a>理解事件流机制 tapable</h2><p><code>webpack</code>本质上是一种事件流的机制，它的工作流程就是将各个插件串联起来，而实现这一切的核心就是Tapable。</p>
<p><code>Webpack</code> 的 <code>Tapable</code> 事件流机制保证了插件的有序性，将各个插件串联起来， Webpack 在运行过程中会广播事件，插件只需要监听它所关心的事件，就能加入到这条webapck机制中，去改变webapck的运作，使得整个系统扩展性良好。</p>
<p><code>Tapable</code>也是一个小型的 library，是<code>Webpack</code>的一个核心工具。类似于<code>node</code>中的<code>events</code>库，核心原理就是一个订阅发布模式。作用是提供类似的插件接口。</p>
<p>webpack中最核心的负责编译的<code>Compiler</code>和负责创建bundles的<code>Compilation</code>都是Tapable的实例，可以直接在 <code>Compiler</code> 和 <code>Compilation</code> 对象上广播和监听事件，方法如下：</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 广播事件</span></span><br><span class="line"><span class="comment">* event-name 为事件名称，注意不要和现有的事件重名</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">compiler.apply(<span class="string">'event-name'</span>,params);</span><br><span class="line">compilation.apply(<span class="string">'event-name'</span>,params);</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 监听事件</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">compiler.plugin(<span class="string">'event-name'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">params</span>)</span>{});</span><br><span class="line">compilation.plugin(<span class="string">'event-name'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">params</span>)</span>{});</span><br></pre></td></tr></tbody></table></figure>
<p><code>Tapable</code>类暴露了<code>tap</code>、<code>tapAsync</code>和<code>tapPromise</code>方法，可以根据钩子的同步/异步方式来选择一个函数注入逻辑。</p>
<p><code>tap</code> 同步钩子<br></p><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">compiler.hooks.compile.tap(<span class="string">'MyPlugin'</span>, params => {</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'以同步方式触及 compile 钩子。'</span>)</span><br><span class="line">})</span><br></pre></td></tr></tbody></table></figure><p></p>
<p><code>tapAsync</code> 异步钩子，通过<code>callback</code>回调告诉<code>Webpack</code>异步执行完毕<br><code>tapPromise</code> 异步钩子，返回一个<code>Promise</code>告诉<code>Webpack</code>异步执行完毕<br></p><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">compiler.hooks.run.tapAsync(<span class="string">'MyPlugin'</span>, (compiler, callback) => {</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'以异步方式触及 run 钩子。'</span>)</span><br><span class="line">  callback()</span><br><span class="line">})</span><br><span class="line"></span><br><span class="line">compiler.hooks.run.tapPromise(<span class="string">'MyPlugin'</span>, compiler => {</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">resolve</span> =></span> setTimeout(resolve, <span class="number">1000</span>)).then(<span class="function"><span class="params">()</span> =></span> {</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'以具有延迟的异步方式触及 run 钩子'</span>)</span><br><span class="line">  })</span><br><span class="line">})</span><br></pre></td></tr></tbody></table></figure><p></p>
<h4 id="Tabable用法"><a href="#Tabable用法" class="headerlink" title="Tabable用法"></a>Tabable用法</h4><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> {</span><br><span class="line">	SyncHook,</span><br><span class="line">	SyncBailHook,</span><br><span class="line">	SyncWaterfallHook,</span><br><span class="line">	SyncLoopHook,</span><br><span class="line">	AsyncParallelHook,</span><br><span class="line">	AsyncParallelBailHook,</span><br><span class="line">	AsyncSeriesHook,</span><br><span class="line">	AsyncSeriesBailHook,</span><br><span class="line">	AsyncSeriesWaterfallHook</span><br><span class="line"> } = <span class="built_in">require</span>(<span class="string">"tapable"</span>);</span><br></pre></td></tr></tbody></table></figure>
<p><img src="https://cdn.6fed.com/github/webpack/plugin/tapable.jpg" alt="tapable"></p>
<h4 id="简单实现一个-SyncHook"><a href="#简单实现一个-SyncHook" class="headerlink" title="简单实现一个 SyncHook"></a>简单实现一个 SyncHook</h4><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Hook</span></span>{</span><br><span class="line">    <span class="keyword">constructor</span>(args){</span><br><span class="line">        <span class="keyword">this</span>.taps = []</span><br><span class="line">        <span class="keyword">this</span>.interceptors = [] <span class="comment">// 这个放在后面用</span></span><br><span class="line">        <span class="keyword">this</span>._args = args </span><br><span class="line">    }</span><br><span class="line">    tap(name,fn){</span><br><span class="line">        <span class="keyword">this</span>.taps.push({name,fn})</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SyncHook</span> <span class="keyword">extends</span> <span class="title">Hook</span></span>{</span><br><span class="line">    call(name,fn){</span><br><span class="line">        <span class="keyword">try</span> {</span><br><span class="line">            <span class="keyword">this</span>.taps.forEach(<span class="function"><span class="params">tap</span> =></span> tap.fn(name))</span><br><span class="line">            fn(<span class="literal">null</span>,name)</span><br><span class="line">        } <span class="keyword">catch</span> (error) {</span><br><span class="line">            fn(error)</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h4 id="tapable是如何将webapck-webpack插件关联的？"><a href="#tapable是如何将webapck-webpack插件关联的？" class="headerlink" title="tapable是如何将webapck/webpack插件关联的？"></a><code>tapable</code>是如何将<code>webapck/webpack</code>插件关联的？</h4><p><strong>Compiler.js</strong><br></p><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> { AsyncSeriesHook ,SyncHook } = <span class="built_in">require</span>(<span class="string">"tapable"</span>);</span><br><span class="line"><span class="comment">//创建类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Compiler</span> </span>{</span><br><span class="line">    <span class="keyword">constructor</span>() {</span><br><span class="line">        <span class="keyword">this</span>.hooks = {</span><br><span class="line">           run: <span class="keyword">new</span> AsyncSeriesHook([<span class="string">"compiler"</span>]), <span class="comment">//异步钩子</span></span><br><span class="line">           compile: <span class="keyword">new</span> SyncHook([<span class="string">"params"</span>]),<span class="comment">//同步钩子</span></span><br><span class="line">        };</span><br><span class="line">    },</span><br><span class="line">    run(){</span><br><span class="line">      <span class="comment">//执行异步钩子</span></span><br><span class="line">      <span class="keyword">this</span>.hooks.run.callAsync(<span class="keyword">this</span>, err => {</span><br><span class="line">         <span class="keyword">this</span>.compile(onCompiled);</span><br><span class="line">      });</span><br><span class="line">    },</span><br><span class="line">    compile(){</span><br><span class="line">      <span class="comment">//执行同步钩子 并传参</span></span><br><span class="line">      <span class="keyword">this</span>.hooks.compile.call(params);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"><span class="built_in">module</span>.exports = Compiler</span><br></pre></td></tr></tbody></table></figure><p></p>
<p><strong>MyPlugin.js</strong><br></p><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> Compiler = <span class="built_in">require</span>(<span class="string">'./Compiler'</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyPlugin</span></span>{</span><br><span class="line">    apply(compiler){<span class="comment">//接受 compiler参数</span></span><br><span class="line">        compiler.hooks.run.tap(<span class="string">"MyPlugin"</span>, () => <span class="built_in">console</span>.log(<span class="string">'开始编译...'</span>));</span><br><span class="line">        compiler.hooks.complier.tapAsync(<span class="string">'MyPlugin'</span>, (name, age) => {</span><br><span class="line">          setTimeout(<span class="function"><span class="params">()</span> =></span> {</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'编译中...'</span>)</span><br><span class="line">          }, <span class="number">1000</span>)</span><br><span class="line">        });</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">//这里类似于webpack.config.js的plugins配置</span></span><br><span class="line"><span class="comment">//向 plugins 属性传入 new 实例</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> myPlugin = <span class="keyword">new</span> MyPlugin();</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> options = {</span><br><span class="line">    plugins: [myPlugin]</span><br><span class="line">}</span><br><span class="line"><span class="keyword">let</span> compiler = <span class="keyword">new</span> Compiler(options)</span><br><span class="line">compiler.run()</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>想要深入了解<code>tapable</code>的文章可以看看这篇文章：</p>
<p><code>webpack4</code>核心模块<code>tapable</code>源码解析:<br><a href="https://www.cnblogs.com/tugenhua0707/p/11317557.html" target="_blank" rel="noopener">https://www.cnblogs.com/tugenhua0707/p/11317557.html</a></p>
<h2 id="理解Compiler（负责编译）"><a href="#理解Compiler（负责编译）" class="headerlink" title="理解Compiler（负责编译）"></a>理解Compiler（负责编译）</h2><p>开发插件首先要知道<code>compiler</code>和 <code>compilation</code> 对象是做什么的 </p>
<p><code>Compiler</code> 对象包含了当前运行<code>Webpack</code>的配置，包括<code>entry、output、loaders</code>等配置，这个对象在启动<code>Webpack</code>时被实例化，而且是全局唯一的。<code>Plugin</code>可以通过该对象获取到Webpack的配置信息进行处理。</p>
<p>如果看完这段话，你还是没理解<code>compiler</code>是做啥的，不要怕，接着看。<br>运行<code>npm run build</code>，把<code>compiler</code>的全部信息输出到控制台上<code>console.log(Compiler)</code>。</p>
<p><img src="https://cdn.6fed.com/github/webpack/plugin/Compiler.jpg" alt="compiler"><br></p><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 为了能更直观的让大家看清楚compiler的结构，里面的大量代码使用省略号（...）代替。</span></span><br><span class="line">Compiler {</span><br><span class="line">  _pluginCompat: SyncBailHook {</span><br><span class="line">    ...</span><br><span class="line">  },</span><br><span class="line">  hooks: {</span><br><span class="line">    shouldEmit: SyncBailHook {</span><br><span class="line">     ...</span><br><span class="line">    },</span><br><span class="line">    done: AsyncSeriesHook {</span><br><span class="line">     ...</span><br><span class="line">    },</span><br><span class="line">    additionalPass: AsyncSeriesHook {</span><br><span class="line">     ...</span><br><span class="line">    },</span><br><span class="line">    beforeRun: AsyncSeriesHook {</span><br><span class="line">     ...</span><br><span class="line">    },</span><br><span class="line">    run: AsyncSeriesHook {</span><br><span class="line">     ...</span><br><span class="line">    },</span><br><span class="line">    emit: AsyncSeriesHook {</span><br><span class="line">     ...</span><br><span class="line">    },</span><br><span class="line">    assetEmitted: AsyncSeriesHook {</span><br><span class="line">     ...</span><br><span class="line">    },</span><br><span class="line">    afterEmit: AsyncSeriesHook {</span><br><span class="line">     ...</span><br><span class="line">    },</span><br><span class="line">    thisCompilation: SyncHook {</span><br><span class="line">     ...</span><br><span class="line">    },</span><br><span class="line">    compilation: SyncHook {</span><br><span class="line">     ...</span><br><span class="line">    },</span><br><span class="line">    normalModuleFactory: SyncHook {</span><br><span class="line">     ...</span><br><span class="line">    },</span><br><span class="line">    contextModuleFactory: SyncHook {</span><br><span class="line">     ...</span><br><span class="line">    },</span><br><span class="line">    beforeCompile: AsyncSeriesHook {</span><br><span class="line">      ...</span><br><span class="line">    },</span><br><span class="line">    compile: SyncHook {</span><br><span class="line">     ...</span><br><span class="line">    },</span><br><span class="line">    make: AsyncParallelHook {</span><br><span class="line">     ...</span><br><span class="line">    },</span><br><span class="line">    afterCompile: AsyncSeriesHook {</span><br><span class="line">     ...</span><br><span class="line">    },</span><br><span class="line">    watchRun: AsyncSeriesHook {</span><br><span class="line">     ...</span><br><span class="line">    },</span><br><span class="line">    failed: SyncHook {</span><br><span class="line">     ...</span><br><span class="line">    },</span><br><span class="line">    invalid: SyncHook {</span><br><span class="line">     ...</span><br><span class="line">    },</span><br><span class="line">    watchClose: SyncHook {</span><br><span class="line">     ...</span><br><span class="line">    },</span><br><span class="line">    infrastructureLog: SyncBailHook {</span><br><span class="line">     ...</span><br><span class="line">    },</span><br><span class="line">    environment: SyncHook {</span><br><span class="line">     ...</span><br><span class="line">    },</span><br><span class="line">    afterEnvironment: SyncHook {</span><br><span class="line">     ...</span><br><span class="line">    },</span><br><span class="line">    afterPlugins: SyncHook {</span><br><span class="line">     ...</span><br><span class="line">    },</span><br><span class="line">    afterResolvers: SyncHook {</span><br><span class="line">     ...</span><br><span class="line">    },</span><br><span class="line">    entryOption: SyncBailHook {</span><br><span class="line">     ...</span><br><span class="line">    },</span><br><span class="line">    infrastructurelog: SyncBailHook {</span><br><span class="line">     ...</span><br><span class="line">    }</span><br><span class="line">  },</span><br><span class="line">  ...</span><br><span class="line">  outputPath: <span class="string">''</span>,<span class="comment">//输出目录</span></span><br><span class="line">  outputFileSystem: NodeOutputFileSystem {</span><br><span class="line">   ...</span><br><span class="line">  },</span><br><span class="line">  inputFileSystem: CachedInputFileSystem {</span><br><span class="line">    ...</span><br><span class="line">  },</span><br><span class="line">  ...</span><br><span class="line">  options: {</span><br><span class="line">    <span class="comment">//Compiler对象包含了webpack的所有配置信息，entry、module、output、resolve等信息</span></span><br><span class="line">    entry: [</span><br><span class="line">      <span class="string">'babel-polyfill'</span>,</span><br><span class="line">      <span class="string">'/Users/frank/Desktop/fe/fe-blog/webpack-plugin/src/index.js'</span></span><br><span class="line">    ],</span><br><span class="line">    devServer: { <span class="attr">port</span>: <span class="number">3000</span> },</span><br><span class="line">    output: {</span><br><span class="line">      ...</span><br><span class="line">    },</span><br><span class="line">    <span class="built_in">module</span>: {</span><br><span class="line">      ...</span><br><span class="line">    },</span><br><span class="line">    plugins: [ MyWebpackPlugin {} ],</span><br><span class="line">    mode: <span class="string">'production'</span>,</span><br><span class="line">    context: <span class="string">'/Users/frank/Desktop/fe/fe-blog/webpack-plugin'</span>,</span><br><span class="line">    devtool: <span class="literal">false</span>,</span><br><span class="line">    ...</span><br><span class="line">    performance: {</span><br><span class="line">      maxAssetSize: <span class="number">250000</span>,</span><br><span class="line">      maxEntrypointSize: <span class="number">250000</span>,</span><br><span class="line">      hints: <span class="string">'warning'</span></span><br><span class="line">    },</span><br><span class="line">    optimization: {</span><br><span class="line">      ... </span><br><span class="line">    },</span><br><span class="line">    resolve: {</span><br><span class="line">      ...</span><br><span class="line">    },</span><br><span class="line">    resolveLoader: {</span><br><span class="line">      ...</span><br><span class="line">    },</span><br><span class="line">    infrastructureLogging: { <span class="attr">level</span>: <span class="string">'info'</span>, <span class="attr">debug</span>: <span class="literal">false</span> }</span><br><span class="line">  },</span><br><span class="line">  context: <span class="string">'/Users/frank/Desktop/fe/fe-blog/webpack-plugin'</span>,<span class="comment">//上下文，文件目录</span></span><br><span class="line">  requestShortener: RequestShortener {</span><br><span class="line">    ...</span><br><span class="line">  },</span><br><span class="line">  ...</span><br><span class="line">  watchFileSystem: NodeWatchFileSystem {</span><br><span class="line">    <span class="comment">//监听文件变化列表信息</span></span><br><span class="line">     ...</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p></p>
<h4 id="Compiler源码精简版代码解析"><a href="#Compiler源码精简版代码解析" class="headerlink" title="Compiler源码精简版代码解析"></a>Compiler源码精简版代码解析</h4><p>源码地址(948行)：<a href="https://github.com/webpack/webpack/blob/master/lib/Compiler.js" target="_blank" rel="noopener">https://github.com/webpack/webpack/blob/master/lib/Compiler.js</a><br></p><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> { SyncHook, SyncBailHook, AsyncSeriesHook } = <span class="built_in">require</span>(<span class="string">"tapable"</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Compiler</span> </span>{</span><br><span class="line">  <span class="keyword">constructor</span>() {</span><br><span class="line">    <span class="comment">// 1. 定义生命周期钩子</span></span><br><span class="line">    <span class="keyword">this</span>.hooks = <span class="built_in">Object</span>.freeze({</span><br><span class="line">      <span class="comment">// ...只列举几个常用的常见钩子，更多hook就不列举了，有兴趣看源码</span></span><br><span class="line">      done: <span class="keyword">new</span> AsyncSeriesHook([<span class="string">"stats"</span>]),<span class="comment">//一次编译完成后执行，回调参数：stats</span></span><br><span class="line">      beforeRun: <span class="keyword">new</span> AsyncSeriesHook([<span class="string">"compiler"</span>]),</span><br><span class="line">      run: <span class="keyword">new</span> AsyncSeriesHook([<span class="string">"compiler"</span>]),<span class="comment">//在编译器开始读取记录前执行</span></span><br><span class="line">      emit: <span class="keyword">new</span> AsyncSeriesHook([<span class="string">"compilation"</span>]),<span class="comment">//在生成文件到output目录之前执行，回调参数： compilation</span></span><br><span class="line">      afterEmit: <span class="keyword">new</span> AsyncSeriesHook([<span class="string">"compilation"</span>]),<span class="comment">//在生成文件到output目录之后执行</span></span><br><span class="line">      compilation: <span class="keyword">new</span> SyncHook([<span class="string">"compilation"</span>, <span class="string">"params"</span>]),<span class="comment">//在一次compilation创建后执行插件</span></span><br><span class="line">      beforeCompile: <span class="keyword">new</span> AsyncSeriesHook([<span class="string">"params"</span>]),</span><br><span class="line">      compile: <span class="keyword">new</span> SyncHook([<span class="string">"params"</span>]),<span class="comment">//在一个新的compilation创建之前执行</span></span><br><span class="line">      make:<span class="keyword">new</span> AsyncParallelHook([<span class="string">"compilation"</span>]),<span class="comment">//完成一次编译之前执行</span></span><br><span class="line">      afterCompile: <span class="keyword">new</span> AsyncSeriesHook([<span class="string">"compilation"</span>]),</span><br><span class="line">      watchRun: <span class="keyword">new</span> AsyncSeriesHook([<span class="string">"compiler"</span>]),</span><br><span class="line">      failed: <span class="keyword">new</span> SyncHook([<span class="string">"error"</span>]),</span><br><span class="line">      watchClose: <span class="keyword">new</span> SyncHook([]),</span><br><span class="line">      afterPlugins: <span class="keyword">new</span> SyncHook([<span class="string">"compiler"</span>]),</span><br><span class="line">      entryOption: <span class="keyword">new</span> SyncBailHook([<span class="string">"context"</span>, <span class="string">"entry"</span>])</span><br><span class="line">    });</span><br><span class="line">    <span class="comment">// ...省略代码</span></span><br><span class="line">  }</span><br><span class="line">  newCompilation() {</span><br><span class="line">    <span class="comment">// 创建Compilation对象回调compilation相关钩子</span></span><br><span class="line">    <span class="keyword">const</span> compilation = <span class="keyword">new</span> Compilation(<span class="keyword">this</span>);</span><br><span class="line">    <span class="comment">//...一系列操作</span></span><br><span class="line">    <span class="keyword">this</span>.hooks.compilation.call(compilation, params); <span class="comment">//compilation对象创建完成 </span></span><br><span class="line">    <span class="keyword">return</span> compilation</span><br><span class="line">  }</span><br><span class="line">  watch() {</span><br><span class="line">    <span class="comment">//如果运行在watch模式则执行watch方法，否则执行run方法</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.running) {</span><br><span class="line">      <span class="keyword">return</span> handler(<span class="keyword">new</span> ConcurrentCompilationError());</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">this</span>.running = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">this</span>.watchMode = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Watching(<span class="keyword">this</span>, watchOptions, handler);</span><br><span class="line">  }</span><br><span class="line">  run(callback) {</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.running) {</span><br><span class="line">      <span class="keyword">return</span> callback(<span class="keyword">new</span> ConcurrentCompilationError());</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">this</span>.running = <span class="literal">true</span>;</span><br><span class="line">    process.nextTick(<span class="function"><span class="params">()</span> =></span> {</span><br><span class="line">      <span class="keyword">this</span>.emitAssets(compilation, err => {</span><br><span class="line">        <span class="keyword">if</span> (err) {</span><br><span class="line">          <span class="comment">// 在编译和输出的流程中遇到异常时，会触发 failed 事件 </span></span><br><span class="line">          <span class="keyword">this</span>.hooks.failed.call(err)</span><br><span class="line">        };</span><br><span class="line">        <span class="keyword">if</span> (compilation.hooks.needAdditionalPass.call()) {</span><br><span class="line">          <span class="comment">// ...</span></span><br><span class="line">          <span class="comment">// done：完成编译</span></span><br><span class="line">          <span class="keyword">this</span>.hooks.done.callAsync(stats, err => {</span><br><span class="line">            <span class="comment">// 创建compilation对象之前   </span></span><br><span class="line">            <span class="keyword">this</span>.compile(onCompiled);</span><br><span class="line">          });</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">this</span>.emitRecords(<span class="function"><span class="params">err</span> =></span> {</span><br><span class="line">          <span class="keyword">this</span>.hooks.done.callAsync(stats, err => {</span><br><span class="line"></span><br><span class="line">          });</span><br><span class="line">        });</span><br><span class="line">      });</span><br><span class="line">    });</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.hooks.beforeRun.callAsync(<span class="keyword">this</span>, err => {</span><br><span class="line">      <span class="keyword">this</span>.hooks.run.callAsync(<span class="keyword">this</span>, err => {</span><br><span class="line">        <span class="keyword">this</span>.readRecords(<span class="function"><span class="params">err</span> =></span> {</span><br><span class="line">          <span class="keyword">this</span>.compile(onCompiled);</span><br><span class="line">        });</span><br><span class="line">      });</span><br><span class="line">    });</span><br><span class="line"></span><br><span class="line">  }</span><br><span class="line">  compile(callback) {</span><br><span class="line">    <span class="keyword">const</span> params = <span class="keyword">this</span>.newCompilationParams();</span><br><span class="line">    <span class="keyword">this</span>.hooks.beforeCompile.callAsync(params, err => {</span><br><span class="line">      <span class="keyword">this</span>.hooks.compile.call(params);</span><br><span class="line">      <span class="keyword">const</span> compilation = <span class="keyword">this</span>.newCompilation(params);</span><br><span class="line">      <span class="comment">//触发make事件并调用addEntry，找到入口js，进行下一步</span></span><br><span class="line">      <span class="keyword">this</span>.hooks.make.callAsync(compilation, err => {</span><br><span class="line">        process.nextTick(<span class="function"><span class="params">()</span> =></span> {</span><br><span class="line">          compilation.finish(<span class="function"><span class="params">err</span> =></span> {</span><br><span class="line">            <span class="comment">// 封装构建结果（seal），逐次对每个module和chunk进行整理，每个chunk对应一个入口文件</span></span><br><span class="line">            compilation.seal(<span class="function"><span class="params">err</span> =></span> {</span><br><span class="line">              <span class="keyword">this</span>.hooks.afterCompile.callAsync(compilation, err => {</span><br><span class="line">                <span class="comment">// 异步的事件需要在插件处理完任务时调用回调函数通知 Webpack 进入下一个流程，</span></span><br><span class="line">                <span class="comment">// 不然运行流程将会一直卡在这不往下执行</span></span><br><span class="line">                <span class="keyword">return</span> callback(<span class="literal">null</span>, compilation);</span><br><span class="line">              });</span><br><span class="line">            });</span><br><span class="line">          });</span><br><span class="line">        });</span><br><span class="line">      });</span><br><span class="line">    });</span><br><span class="line">  }</span><br><span class="line">  emitAssets(compilation, callback) {</span><br><span class="line">    <span class="keyword">const</span> emitFiles = <span class="function">(<span class="params">err</span>) =></span> {</span><br><span class="line">      <span class="comment">//...省略一系列代码</span></span><br><span class="line">      <span class="comment">// afterEmit：文件已经写入磁盘完成</span></span><br><span class="line">      <span class="keyword">this</span>.hooks.afterEmit.callAsync(compilation, err => {</span><br><span class="line">        <span class="keyword">if</span> (err) <span class="keyword">return</span> callback(err);</span><br><span class="line">        <span class="keyword">return</span> callback();</span><br><span class="line">      });</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">// emit 事件发生时，可以读取到最终输出的资源、代码块、模块及其依赖，并进行修改(这是最后一次修改最终文件的机会)</span></span><br><span class="line">    <span class="keyword">this</span>.hooks.emit.callAsync(compilation, err => {</span><br><span class="line">      <span class="keyword">if</span> (err) <span class="keyword">return</span> callback(err);</span><br><span class="line">      outputPath = compilation.getPath(<span class="keyword">this</span>.outputPath, {});</span><br><span class="line">      mkdirp(<span class="keyword">this</span>.outputFileSystem, outputPath, emitFiles);</span><br><span class="line">    });</span><br><span class="line">  }</span><br><span class="line">  <span class="comment">// ...省略代码</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p></p>
<p><code>apply</code>方法中插入钩子的一般形式如下：<br></p><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// compiler提供了compiler.hooks，可以根据这些不同的时刻去让插件做不同的事情。</span></span><br><span class="line">compiler.hooks.阶段.tap函数(<span class="string">'插件名称'</span>, (阶段回调参数) => {</span><br><span class="line"></span><br><span class="line">});</span><br><span class="line">compiler.run(callback)</span><br></pre></td></tr></tbody></table></figure><p></p>
<h2 id="理解Compilation（负责创建bundles）"><a href="#理解Compilation（负责创建bundles）" class="headerlink" title="理解Compilation（负责创建bundles）"></a>理解Compilation（负责创建bundles）</h2><p><code>Compilation</code>对象代表了一次资源版本构建。当运行 <code>webpack</code> 开发环境中间件时，每当检测到一个文件变化，就会创建一个新的 <code>compilation</code>，从而生成一组新的编译资源。一个 <code>Compilation</code> 对象表现了当前的模块资源、编译生成资源、变化的文件、以及被跟踪依赖的状态信息，简单来讲就是把本次打包编译的内容存到内存里。<code>Compilation</code> 对象也提供了插件需要自定义功能的回调，以供插件做自定义处理时选择使用拓展。</p>
<p>简单来说,<code>Compilation</code>的职责就是构建模块和Chunk，并利用插件优化构建过程。</p>
<p>和 <code>Compiler</code> 用法相同，钩子类型不同，也可以在某些钩子上访问 <code>tapAsync</code> 和 <code>tapPromise。</code></p>
<p>控制台输出<code>console.log(compilation)</code><br><img src="https://cdn.6fed.com/github/webpack/plugin/compilation.jpg" alt="compilation"></p>
<p>通过 <code>Compilation</code> 也能读取到 <code>Compiler</code> 对象。</p>
<p>源码2000多行，看不动了- -，有兴趣的可以自己看看。<br><a href="https://github.com/webpack/webpack/blob/master/lib/Compilation.js" target="_blank" rel="noopener">https://github.com/webpack/webpack/blob/master/lib/Compilation.js</a></p>
<h4 id="介绍几个常用的Compilation-Hooks"><a href="#介绍几个常用的Compilation-Hooks" class="headerlink" title="介绍几个常用的Compilation Hooks"></a>介绍几个常用的Compilation Hooks</h4><table>
<thead>
<tr>
<th>钩子</th>
<th>类型</th>
<th>什么时候调用</th>
</tr>
</thead>
<tbody>
<tr>
<td>buildModule</td>
<td>SyncHook</td>
<td>在模块开始编译之前触发，可以用于修改模块</td>
</tr>
<tr>
<td>succeedModule</td>
<td>SyncHook</td>
<td>当一个模块被成功编译，会执行这个钩子</td>
</tr>
<tr>
<td>finishModules</td>
<td>AsyncSeriesHook</td>
<td>当所有模块都编译成功后被调用</td>
</tr>
<tr>
<td>seal</td>
<td>SyncHook</td>
<td>当一次<code>compilation</code>停止接收新模块时触发</td>
</tr>
<tr>
<td>optimizeDependencies</td>
<td>SyncBailHook</td>
<td>在依赖优化的开始执行</td>
</tr>
<tr>
<td>optimize</td>
<td>SyncHook</td>
<td>在优化阶段的开始执行</td>
</tr>
<tr>
<td>optimizeModules</td>
<td>SyncBailHook</td>
<td>在模块优化阶段开始时执行，插件可以在这个钩子里执行对模块的优化，回调参数：<code>modules</code></td>
</tr>
<tr>
<td>optimizeChunks</td>
<td>SyncBailHook</td>
<td>在代码块优化阶段开始时执行，插件可以在这个钩子里执行对代码块的优化，回调参数：<code>chunks</code></td>
</tr>
<tr>
<td>optimizeChunkAssets</td>
<td>AsyncSeriesHook</td>
<td>优化任何代码块资源，这些资源存放在<code>compilation.assets</code> 上。一个 chunk 有一个 files 属性，它指向由一个chunk创建的所有文件。任何额外的 chunk 资源都存放在 <code>compilation.additionalChunkAssets</code> 上。回调参数：<code>chunks</code></td>
</tr>
<tr>
<td>optimizeAssets</td>
<td>AsyncSeriesHook</td>
<td>优化所有存放在 <code>compilation.assets</code> 的所有资源。回调参数：<code>assets</code></td>
</tr>
</tbody>
</table>
<h2 id="Compiler-和-Compilation-的区别"><a href="#Compiler-和-Compilation-的区别" class="headerlink" title="Compiler 和 Compilation 的区别"></a>Compiler 和 Compilation 的区别</h2><p><code>Compiler</code> 代表了整个 <code>Webpack</code> 从启动到关闭的生命周期，而 <code>Compilation</code> 只是代表了一次新的编译，只要文件有改动，<code>compilation</code>就会被重新创建。</p>
<h2 id="常用-API"><a href="#常用-API" class="headerlink" title="常用 API"></a>常用 API</h2><p>插件可以用来修改输出文件、增加输出文件、甚至可以提升 <code>Webpack</code> 性能、等等，总之插件通过调用<code>Webpack</code> 提供的 <code>API</code> 能完成很多事情。 由于 <code>Webpack</code>提供的 <code>API</code> 非常多，有很多 <code>API</code> 很少用的上，又加上篇幅有限，下面来介绍一些常用的 API。</p>
<h4 id="读取输出资源、代码块、模块及其依赖"><a href="#读取输出资源、代码块、模块及其依赖" class="headerlink" title="读取输出资源、代码块、模块及其依赖"></a>读取输出资源、代码块、模块及其依赖</h4><p>有些插件可能需要读取 <code>Webpack</code> 的处理结果，例如输出资源、代码块、模块及其依赖，以便做下一步处理。<br>在 emit 事件发生时，代表源文件的转换和组装已经完成，在这里可以读取到最终将输出的资源、代码块、模块及其依赖，并且可以修改输出资源的内容。<br>插件代码如下：</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Plugin</span> </span>{</span><br><span class="line">  apply(compiler) {</span><br><span class="line">    compiler.plugin(<span class="string">'emit'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">compilation, callback</span>) </span>{</span><br><span class="line">      <span class="comment">// compilation.chunks 存放所有代码块，是一个数组</span></span><br><span class="line">      compilation.chunks.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">chunk</span>) </span>{</span><br><span class="line">        <span class="comment">// chunk 代表一个代码块</span></span><br><span class="line">        <span class="comment">// 代码块由多个模块组成，通过 chunk.forEachModule 能读取组成代码块的每个模块</span></span><br><span class="line">        chunk.forEachModule(<span class="function"><span class="keyword">function</span> (<span class="params">module</span>) </span>{</span><br><span class="line">          <span class="comment">// module 代表一个模块</span></span><br><span class="line">          <span class="comment">// module.fileDependencies 存放当前模块的所有依赖的文件路径，是一个数组</span></span><br><span class="line">          <span class="built_in">module</span>.fileDependencies.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">filepath</span>) </span>{</span><br><span class="line">          });</span><br><span class="line">        });</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Webpack 会根据 Chunk 去生成输出的文件资源，每个 Chunk 都对应一个及其以上的输出文件</span></span><br><span class="line">        <span class="comment">// 例如在 Chunk 中包含了 CSS 模块并且使用了 ExtractTextPlugin 时，</span></span><br><span class="line">        <span class="comment">// 该 Chunk 就会生成 .js 和 .css 两个文件</span></span><br><span class="line">        chunk.files.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">filename</span>) </span>{</span><br><span class="line">          <span class="comment">// compilation.assets 存放当前所有即将输出的资源</span></span><br><span class="line">          <span class="comment">// 调用一个输出资源的 source() 方法能获取到输出资源的内容</span></span><br><span class="line">          <span class="keyword">let</span> source = compilation.assets[filename].source();</span><br><span class="line">        });</span><br><span class="line">      });</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 这是一个异步事件，要记得调用 callback 通知 Webpack 本次事件监听处理结束。</span></span><br><span class="line">      <span class="comment">// 如果忘记了调用 callback，Webpack 将一直卡在这里而不会往后执行。</span></span><br><span class="line">      callback();</span><br><span class="line">    })</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h4 id="监听文件变化"><a href="#监听文件变化" class="headerlink" title="监听文件变化"></a>监听文件变化</h4><p><code>Webpack</code> 会从配置的入口模块出发，依次找出所有的依赖模块，当入口模块或者其依赖的模块发生变化时， 就会触发一次新的 <code>Compilation</code>。</p>
<p>在开发插件时经常需要知道是哪个文件发生变化导致了新的 <code>Compilation</code>，为此可以使用如下代码：<br></p><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 当依赖的文件发生变化时会触发 watch-run 事件</span></span><br><span class="line">compiler.hooks.watchRun.tap(<span class="string">'MyPlugin'</span>, (watching, callback) => {</span><br><span class="line">  <span class="comment">// 获取发生变化的文件列表</span></span><br><span class="line">  <span class="keyword">const</span> changedFiles = watching.compiler.watchFileSystem.watcher.mtimes;</span><br><span class="line">  <span class="comment">// changedFiles 格式为键值对，键为发生变化的文件路径。</span></span><br><span class="line">  <span class="keyword">if</span> (changedFiles[filePath] !== <span class="literal">undefined</span>) {</span><br><span class="line">    <span class="comment">// filePath 对应的文件发生了变化</span></span><br><span class="line">  }</span><br><span class="line">  callback();</span><br><span class="line">});</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>默认情况下 <code>Webpack</code> 只会监视入口和其依赖的模块是否发生变化，在有些情况下项目可能需要引入新的文件，例如引入一个 <code>HTML</code> 文件。 由于 <code>JavaScript</code> 文件不会去导入 <code>HTML</code> 文件，<code>Webpack</code> 就不会监听 <code>HTML</code> 文件的变化，编辑 <code>HTML</code> 文件时就不会重新触发新的 <code>Compilation</code>。 为了监听 <code>HTML</code> 文件的变化，我们需要把 <code>HTML</code> 文件加入到依赖列表中，为此可以使用如下代码：<br></p><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">compiler.hooks.afterCompile.tap(<span class="string">'MyPlugin'</span>, (compilation, callback) => {</span><br><span class="line">  <span class="comment">// 把 HTML 文件添加到文件依赖列表，好让 Webpack 去监听 HTML 模块文件，在 HTML 模版文件发生变化时重新启动一次编译</span></span><br><span class="line">  compilation.fileDependencies.push(filePath);</span><br><span class="line">  callback();</span><br><span class="line">});</span><br></pre></td></tr></tbody></table></figure><p></p>
<h4 id="修改输出资源"><a href="#修改输出资源" class="headerlink" title="修改输出资源"></a>修改输出资源</h4><p>有些场景下插件需要修改、增加、删除输出的资源，要做到这点需要监听 <code>emit</code> 事件，因为发生 <code>emit</code> 事件时所有模块的转换和代码块对应的文件已经生成好， 需要输出的资源即将输出，因此emit事件是修改 Webpack 输出资源的最后时机。</p>
<p>所有需要输出的资源会存放在 <code>compilation.assets</code> 中，<code>compilation.assets</code> 是一个键值对，键为需要输出的文件名称，值为文件对应的内容。</p>
<p>设置 <code>compilation.assets</code> 的代码如下：</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 设置名称为 fileName 的输出资源</span></span><br><span class="line">  compilation.assets[fileName] = {</span><br><span class="line">    <span class="comment">// 返回文件内容</span></span><br><span class="line">    source: <span class="function"><span class="params">()</span> =></span> {</span><br><span class="line">      <span class="comment">// fileContent 既可以是代表文本文件的字符串，也可以是代表二进制文件的 Buffer</span></span><br><span class="line">      <span class="keyword">return</span> fileContent;</span><br><span class="line">      },</span><br><span class="line">    <span class="comment">// 返回文件大小</span></span><br><span class="line">      size: <span class="function"><span class="params">()</span> =></span> {</span><br><span class="line">      <span class="keyword">return</span> Buffer.byteLength(fileContent, <span class="string">'utf8'</span>);</span><br><span class="line">    }</span><br><span class="line">  };</span><br><span class="line">  callback();</span><br></pre></td></tr></tbody></table></figure>
<h4 id="判断webpack使用了哪些插件"><a href="#判断webpack使用了哪些插件" class="headerlink" title="判断webpack使用了哪些插件"></a>判断webpack使用了哪些插件</h4><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 判断当前配置使用使用了 ExtractTextPlugin，</span></span><br><span class="line"><span class="comment">// compiler 参数即为 Webpack 在 apply(compiler) 中传入的参数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">hasExtractTextPlugin</span>(<span class="params">compiler</span>) </span>{</span><br><span class="line">  <span class="comment">// 当前配置所有使用的插件列表</span></span><br><span class="line">  <span class="keyword">const</span> plugins = compiler.options.plugins;</span><br><span class="line">  <span class="comment">// 去 plugins 中寻找有没有 ExtractTextPlugin 的实例</span></span><br><span class="line">  <span class="keyword">return</span> plugins.find(<span class="function"><span class="params">plugin</span>=></span>plugin.__proto__.constructor === ExtractTextPlugin) != <span class="literal">null</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>以上4种方法来源于文章：<br>[Webpack学习－Plugin] :<a href="http://wushaobin.top/2019/03/15/webpackPlugin/" target="_blank" rel="noopener">http://wushaobin.top/2019/03/15/webpackPlugin/</a></p>
<h4 id="管理-Warnings-和-Errors"><a href="#管理-Warnings-和-Errors" class="headerlink" title="管理 Warnings 和 Errors"></a>管理 Warnings 和 Errors</h4><p>做一个实验，如果你在 <code>apply</code>函数内插入 <code>throw new Error("Message")</code>，会发生什么，终端会打印出 <code>Unhandled rejection Error: Message</code>。然后 webpack 中断执行。<br>为了不影响 <code>webpack</code> 的执行，要在编译期间向用户发出警告或错误消息，则应使用 compilation.warnings 和 compilation.errors。<br></p><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">compilation.warnings.push(<span class="string">"warning"</span>);</span><br><span class="line">compilation.errors.push(<span class="string">"error"</span>);</span><br></pre></td></tr></tbody></table></figure><p></p>
<h2 id="文章中的案例demo代码展示"><a href="#文章中的案例demo代码展示" class="headerlink" title="文章中的案例demo代码展示"></a>文章中的案例demo代码展示</h2><p><a href="https://github.com/6fedcom/fe-blog/tree/master/webpack/plugin" target="_blank" rel="noopener">https://github.com/6fedcom/fe-blog/tree/master/webpack/plugin</a></p>
<h2 id="webpack打包过程或者插件代码里该如何调试？"><a href="#webpack打包过程或者插件代码里该如何调试？" class="headerlink" title="webpack打包过程或者插件代码里该如何调试？"></a>webpack打包过程或者插件代码里该如何调试？</h2><ol>
<li>在当前webpack项目工程文件夹下面，执行命令行：</li>
</ol>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node --inspect-brk ./node_modules/webpack/bin/webpack.js --inline --progress</span><br></pre></td></tr></tbody></table></figure>
<p>其中参数–inspect-brk就是以调试模式启动node：</p>
<p>终端会输出：<br></p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Debugger listening on ws://127.0.0.1:9229/1018c03f-7473-4d60-b62c-949a6404c81d</span><br><span class="line">For help, see: https://nodejs.org/en/docs/inspector</span><br></pre></td></tr></tbody></table></figure><p></p>
<ol start="2">
<li>谷歌浏览器输入 chrome://inspect/#devices</li>
</ol>
<p><img src="https://cdn.6fed.com/github/webpack/plugin/inspect.jpg" alt="点击inspect"></p>
<ol start="3">
<li>然后点一下Chrome调试器里的“继续执行”，断点就提留在我们设置在插件里的debugger断点了。</li>
</ol>
<p><img src="https://cdn.6fed.com/github/webpack/plugin/debugger.jpg" alt="debugger"></p>

            <div class="post-copyright">
    <div class="content">
        <!-- <p>最后更新： 2020年05月19日 00:43</p> -->
        <p>转载请保持原始链接</p>
        <p>原始链接： <a class="post-url" href="/note/9f79cea2.html" title="揭秘webpack插件工作流程和原理">https://ru23.com/note/9f79cea2.html</a></p>
        <footer>
            <a href="https://ru23.com">
                <img src="//cdn.ru23.com/img/images/chrome.png" alt="frank">
                frank
            </a>
        </footer>
    </div>
</div>

            
            
            

            
        </div>
        <footer class="article-footer">
            
            
<div class="post-share">
    <a href="javascript:;" id="share-sub" class="post-share-fab">
        <i class="fa fa-share-alt"></i>
    </a>
    <div class="post-share-list" id="share-list">
        <ul class="share-icons">
          <li>
            <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://ru23.com/note/9f79cea2.html&title=《揭秘webpack插件工作流程和原理》 — 前端迷&pic=//cdn.ru23.com/img/images/chrome.png" data-title="微博">
              <i class="fa fa-weibo"></i>
            </a>
          </li>
          <li>
            <a class="weixin share-sns" id="wxFab" href="javascript:;" data-title="微信">
              <i class="fa fa-weixin"></i>
            </a>
          </li>
          <li>
            <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://ru23.com/note/9f79cea2.html&title=《揭秘webpack插件工作流程和原理》 — 前端迷&source=frank，前端开发爱好者，沉迷前端，无法自拔,欢迎一切技术交流（不局限于前端），邮箱fanqianweb@gmail.com" data-title="QQ">
              <i class="fa fa-qq"></i>
            </a>
          </li>
          <li>
            <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://ru23.com/note/9f79cea2.html" data-title="Facebook">
              <i class="fa fa-facebook"></i>
            </a>
          </li>
          <li>
            <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《揭秘webpack插件工作流程和原理》 — 前端迷&url=https://ru23.com/note/9f79cea2.html&via=https://ru23.com" data-title="Twitter">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
          <li>
            <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://ru23.com/note/9f79cea2.html" data-title="Google+">
              <i class="fa fa-google-plus"></i>
            </a>
          </li>
        </ul>
     </div>
</div>
<div class="post-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;" id="wxShare-close">×</a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAK4AAACuCAAAAACKZ2kyAAAByUlEQVR42u3aQW6EMAwF0Ln/panUVRcl+Y5JRKuX1QgheMzCyrfz+cTr+l7j69eP1bnzgYWLi9vmXsN197Lx7zHx7vnje3Bxcc9z89IzedzNH1H91NvruLi4L+NW9xtjHC4u7v/gjjcxdx+Qb4BwcXHfxs3DSXUrk7RatmQ1XFzcZ9JK4dHP/t7Y38XFxS1yr+JKtjL51qf8dlxc3CPcJJYkr1wrhWuNElxc3N3cfNiZF69qcEqCEC4u7klutZzlTc/OMDUqrLi4uJu51aCSNDWSYrQWunBxcXdz1wpTZxBSDTy/dHFwcXE3c/vNzU4qya+36i4uLu4St9CMaAShTtHExcU9ya2Gkzz25GWrsPXBxcU9yF0rVTsaKJOPwcXFPcitDkfHoM7IdhKocHFxj3CrOalakvIjGnlTFRcXdzc3PzKVH6HoNFUnxRQXF/cgt3B6qxhaqqVw8hZcXNyD3OpINS9/1WhUnvbg4uJu4FYLSj726HzS4pQYFxf3UW51HJIT8+fg4uK+k1vusy5B+0e+cHFx38attkerEShpu+Di4v5Fbn8DNElpuLi4B7nPHqJ6KlC1shouLm6Du9YwXaN0tkG4uLhHuF9INGzDdYKbjwAAAABJRU5ErkJggg==" alt="微信分享二维码">
</div>

<div class="mask"></div>

            
            <ul class="article-footer-menu">
                
                
  <li class="article-footer-tags">
    <i class="fa fa-tags"></i>
      
    <a href="/tags/webpack/" class="color3">webpack</a>
      
  </li>

            </ul>
            
        </footer>
    </div>
</article>


    <aside class="post-toc-pos post-toc-top" id="post-toc">
        <nav class="post-toc-wrap">
            <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#前言"><span class="post-toc-text">前言</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#插件基本结构"><span class="post-toc-text">插件基本结构</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#一个简单的插件结构："><span class="post-toc-text">一个简单的插件结构：</span></a></li></ol></li></ol><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#webapck-构建流程"><span class="post-toc-text">webapck 构建流程</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#理解事件流机制-tapable"><span class="post-toc-text">理解事件流机制 tapable</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Tabable用法"><span class="post-toc-text">Tabable用法</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#简单实现一个-SyncHook"><span class="post-toc-text">简单实现一个 SyncHook</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#tapable是如何将webapck-webpack插件关联的？"><span class="post-toc-text">tapable是如何将webapck/webpack插件关联的？</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#理解Compiler（负责编译）"><span class="post-toc-text">理解Compiler（负责编译）</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Compiler源码精简版代码解析"><span class="post-toc-text">Compiler源码精简版代码解析</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#理解Compilation（负责创建bundles）"><span class="post-toc-text">理解Compilation（负责创建bundles）</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#介绍几个常用的Compilation-Hooks"><span class="post-toc-text">介绍几个常用的Compilation Hooks</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Compiler-和-Compilation-的区别"><span class="post-toc-text">Compiler 和 Compilation 的区别</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#常用-API"><span class="post-toc-text">常用 API</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#读取输出资源、代码块、模块及其依赖"><span class="post-toc-text">读取输出资源、代码块、模块及其依赖</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#监听文件变化"><span class="post-toc-text">监听文件变化</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#修改输出资源"><span class="post-toc-text">修改输出资源</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#判断webpack使用了哪些插件"><span class="post-toc-text">判断webpack使用了哪些插件</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#管理-Warnings-和-Errors"><span class="post-toc-text">管理 Warnings 和 Errors</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#文章中的案例demo代码展示"><span class="post-toc-text">文章中的案例demo代码展示</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#webpack打包过程或者插件代码里该如何调试？"><span class="post-toc-text">webpack打包过程或者插件代码里该如何调试？</span></a></li>
        </nav>
    </aside>
    

<nav id="article-nav">
  
  
    <a href="/note/5ed37b6f.html" id="article-nav-older" class="article-nav-link-wrap">
      <span class="article-nav-title">常见loader源码简析，以及动手实现一个md2html-loader</span>
      <i class="fa fa-hand-o-right" aria-hidden="true"></i>
    </a>
  
</nav>




<!-- Valine Comments -->
<div class="comments vcomment" id="comments"></div>
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src="//unpkg.com/valine@latest/dist/Valine.min.js"></script>
<!-- Valine Comments script -->
<script>
    var GUEST_INFO = ['nick', 'mail', 'link'];
    var guest_info = 'nick,mail,link'.split(',').filter(function (item) {
        return GUEST_INFO.indexOf(item) > -1
    });
    new Valine({
        el: '#comments',
        notify: 'true' == 'true',
        verify: 'false' == 'true',
        appId: "OOiJvCREqswvpnTL4RuSShLq-gzGzoHsz",
        appKey: "OPfVBB2YjMrT3ngcc8mu6w8g",
        avatar: "mm",
        qrcode: "",
        placeholder: "输入评论...",
        guest_info: guest_info.length == 0 ? GUEST_INFO : guest_info,
        pageSize: "10"
    })
</script>
<!-- Valine Comments end -->

</section>
        <div class="outer-ad-aside" id="outer-ad-aside">
          
          
          <a style="display: block;" title="阿里云双十二大促，新老用户皆可返现" target="_blank" href="https://www.aliyun.com/minisite/goods?userCode=jh5fwy2j&share_source=copy_link">
            
            <div class="ad-text" style="text-align:center;color: red;">
              阿里云双十二大促，新老用户皆可返现
            </div>
            
            <img src="https://img.alicdn.com/tfs/TB1_rYHo7P2gK0jSZPxXXacQpXa-690-388.jpg" alt="阿里云双十二大促，新老用户皆可返现">
          </a>
          
          <a style="display: block;" title="【腾讯云】云产品采购季，助力行业复工。1核2G云服务器，首年99元" target="_blank" href="https://url.cn/50C5WrF">
            
            <div class="ad-text" style="text-align:center;color: red;">
              【腾讯云】云产品采购季，助力行业复工。1核2G云服务器，首年99元
            </div>
            
            <img src="https://upload-dianshi-1255598498.file.myqcloud.com/345x200-c37e147ab2b4b8074e63d71ca21420cf1a7d4933.png" alt="【腾讯云】云产品采购季，助力行业复工。1核2G云服务器，首年99元">
          </a>
          
          <a style="display: block;" title="微信公众号：前端迷" target="_blank" ">
            
            <img src="//cdn.ru23.com/hexo/public/wechat-mp.png" alt>
          </a>
          
          <a style="display: block;" title="微信前端技术交流群" target="_blank" ">
            
            <img src="//cdn.ru23.com/hexo/public/group.png" alt>
          </a>
          
          <a style="display: block;" target="_blank" ">
            
            <div class="ad-text" style="text-align:center;color: red;">
              广告位出售，日ip100+，联系vx:qianduanmi,备注广告，价格5元/月，随时上线
            </div>
            
            <img src=" https://cdn.ru23.com/common/sale.png" alt="广告位出售，日ip100+，联系vx:qianduanmi,备注广告，价格5元/月，随时上线">
          </a>
          
          
        </div>
      </div>
      
    </div>
    <footer id="footer">
    <div class="outer">
        <div id="footer-info" class="inner">
            
<p>
    <span id="busuanzi_container_site_uv" style="display:none">
        总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style="display:none">
        总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>



                <p>
                    CDN 存储在
                    <a href="https://console.upyun.com/register/?invite=SJ3dme4q8" target="_blank">
                        <style>
                            .upyun0box {
                                width: 14px;
                                height: 14px;
                                position: relative;
                                top: 3px;
                            }
                        </style>
                        <img class="upyun0box" src="https://www.upyun.com/static/favicon-64x64.png"> 又拍云
                    </a>
                    <br>
                </p>
                <p>
                    Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> 主题是 <a href="https://github.com/6fedcom/fe-hexo-blog" target="_blank">基于MiHo主题优化</a> ©
                    2020
                        frank<br>
                </p>
        </div>
    </div>
</footer>
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<script src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
<script src="https://js.fundebug.cn/fundebug.1.5.1.min.js" apikey="912ba8d8c6f372862c218e996a28cebb732bbb78559e974fc031204c813142f9"></script>
<script>
  var mihoConfig = {
    root: "https://ru23.com",
    animate: false,
    isHome: false,
    share: true,
    reward: 2
  }
</script>
<div class="sidebar">
    <div id="sidebar-search" title="Search">
        <i class="fa fa-search"></i>
    </div>
    <div id="sidebar-category" title="Categories">
        <i class="fa fa-book"></i>
    </div>
    <div id="sidebar-tag" title="Tags">
        <i class="fa fa-tags"></i>
    </div>
    <div id="sidebar-top">
        <span class="sidebar-top-icon"><i class="fa fa-angle-up"></i></span>
    </div>
</div>
<div class="sidebar-menu-box" id="sidebar-menu-box">
    <div class="sidebar-menu-box-container">
        <div id="sidebar-menu-box-categories">
            <a class="category-link" href="/categories/algorithm/">algorithm</a><a class="category-link" href="/categories/back-end/">back-end</a><a class="category-link" href="/categories/fed-shared/">fed-shared</a><a class="category-link" href="/categories/front-end/">front-end</a><a class="category-link" href="/categories/hexo/">hexo</a><a class="category-link" href="/categories/tools/">tools</a><a class="category-link" href="/categories/前端自动化/">前端自动化</a>
        </div>
        <div id="sidebar-menu-box-tags">
            <a href="/tags/CSS/" style="font-size: 13.08px;">CSS</a> <a href="/tags/Emmet/" style="font-size: 10px;">Emmet</a> <a href="/tags/HTTP/" style="font-size: 10.77px;">HTTP</a> <a href="/tags/Immutable/" style="font-size: 11.54px;">Immutable</a> <a href="/tags/MVC/" style="font-size: 10px;">MVC</a> <a href="/tags/Snippet/" style="font-size: 13.08px;">Snippet</a> <a href="/tags/Vue/" style="font-size: 13.08px;">Vue</a> <a href="/tags/ajax/" style="font-size: 11.54px;">ajax</a> <a href="/tags/angular/" style="font-size: 10px;">angular</a> <a href="/tags/api/" style="font-size: 12.31px;">api</a> <a href="/tags/atom/" style="font-size: 10px;">atom</a> <a href="/tags/axios/" style="font-size: 12.31px;">axios</a> <a href="/tags/bootstrap/" style="font-size: 10.77px;">bootstrap</a> <a href="/tags/canvas/" style="font-size: 11.54px;">canvas</a> <a href="/tags/cookie/" style="font-size: 10px;">cookie</a> <a href="/tags/css/" style="font-size: 16.15px;">css</a> <a href="/tags/dom/" style="font-size: 13.08px;">dom</a> <a href="/tags/dva/" style="font-size: 11.54px;">dva</a> <a href="/tags/echart/" style="font-size: 10px;">echart</a> <a href="/tags/editconfig/" style="font-size: 10px;">editconfig</a> <a href="/tags/es6/" style="font-size: 13.85px;">es6</a> <a href="/tags/eslint/" style="font-size: 10.77px;">eslint</a> <a href="/tags/fed-shared/" style="font-size: 11.54px;">fed-shared</a> <a href="/tags/fetch/" style="font-size: 10px;">fetch</a> <a href="/tags/flex/" style="font-size: 10px;">flex</a> <a href="/tags/front-end/" style="font-size: 10px;">front-end</a> <a href="/tags/git/" style="font-size: 10px;">git</a> <a href="/tags/github/" style="font-size: 12.31px;">github</a> <a href="/tags/gulp/" style="font-size: 10.77px;">gulp</a> <a href="/tags/hexo/" style="font-size: 10.77px;">hexo</a> <a href="/tags/hide/" style="font-size: 10.77px;">hide</a> <a href="/tags/html5/" style="font-size: 16.92px;">html5</a> <a href="/tags/http/" style="font-size: 10px;">http</a> <a href="/tags/hybrid/" style="font-size: 10px;">hybrid</a> <a href="/tags/javascript/" style="font-size: 20px;">javascript</a> <a href="/tags/jquery/" style="font-size: 17.69px;">jquery</a> <a href="/tags/js/" style="font-size: 10px;">js</a> <a href="/tags/js代码片段/" style="font-size: 12.31px;">js代码片段</a> <a href="/tags/mock/" style="font-size: 10px;">mock</a> <a href="/tags/ms/" style="font-size: 10px;">ms</a> <a href="/tags/mvvm/" style="font-size: 11.54px;">mvvm</a> <a href="/tags/nginx/" style="font-size: 12.31px;">nginx</a> <a href="/tags/node/" style="font-size: 13.85px;">node</a> <a href="/tags/npm/" style="font-size: 13.08px;">npm</a> <a href="/tags/promise/" style="font-size: 10px;">promise</a> <a href="/tags/react/" style="font-size: 19.23px;">react</a> <a href="/tags/redux/" style="font-size: 13.08px;">redux</a> <a href="/tags/sublime/" style="font-size: 15.38px;">sublime</a> <a href="/tags/svn/" style="font-size: 10.77px;">svn</a> <a href="/tags/taro/" style="font-size: 10px;">taro</a> <a href="/tags/todolist/" style="font-size: 10px;">todolist</a> <a href="/tags/video/" style="font-size: 10px;">video</a> <a href="/tags/vscode/" style="font-size: 11.54px;">vscode</a> <a href="/tags/vue/" style="font-size: 18.46px;">vue</a> <a href="/tags/vuex/" style="font-size: 10.77px;">vuex</a> <a href="/tags/webpack/" style="font-size: 14.62px;">webpack</a> <a href="/tags/webstorm/" style="font-size: 10px;">webstorm</a> <a href="/tags/xhtml/" style="font-size: 10px;">xhtml</a> <a href="/tags/中间件/" style="font-size: 10px;">中间件</a> <a href="/tags/事件/" style="font-size: 10px;">事件</a> <a href="/tags/事件流/" style="font-size: 10px;">事件流</a> <a href="/tags/优质文章分享/" style="font-size: 11.54px;">优质文章分享</a> <a href="/tags/作用域/" style="font-size: 10px;">作用域</a> <a href="/tags/前端优化/" style="font-size: 10.77px;">前端优化</a> <a href="/tags/前端基础/" style="font-size: 10px;">前端基础</a> <a href="/tags/前端自动化/" style="font-size: 10px;">前端自动化</a> <a href="/tags/前端规范/" style="font-size: 14.62px;">前端规范</a> <a href="/tags/原型链/" style="font-size: 10px;">原型链</a> <a href="/tags/小程序/" style="font-size: 13.85px;">小程序</a> <a href="/tags/居中/" style="font-size: 10px;">居中</a> <a href="/tags/异步回调/" style="font-size: 10px;">异步回调</a> <a href="/tags/微信开发/" style="font-size: 11.54px;">微信开发</a> <a href="/tags/快应用/" style="font-size: 10px;">快应用</a> <a href="/tags/性能优化/" style="font-size: 10px;">性能优化</a> <a href="/tags/排序算法/" style="font-size: 10px;">排序算法</a> <a href="/tags/最佳实践/" style="font-size: 10px;">最佳实践</a> <a href="/tags/正则表达式/" style="font-size: 10.77px;">正则表达式</a> <a href="/tags/测试/" style="font-size: 10px;">测试</a> <a href="/tags/知识点/" style="font-size: 11.54px;">知识点</a> <a href="/tags/移动端/" style="font-size: 13.08px;">移动端</a> <a href="/tags/组件化/" style="font-size: 10px;">组件化</a> <a href="/tags/继承/" style="font-size: 10.77px;">继承</a> <a href="/tags/缓存/" style="font-size: 10px;">缓存</a> <a href="/tags/读书笔记/" style="font-size: 10.77px;">读书笔记</a> <a href="/tags/跨域/" style="font-size: 11.54px;">跨域</a> <a href="/tags/踩过的坑/" style="font-size: 16.92px;">踩过的坑</a> <a href="/tags/适配/" style="font-size: 10px;">适配</a> <a href="/tags/速查表/" style="font-size: 10px;">速查表</a> <a href="/tags/部署/" style="font-size: 10.77px;">部署</a> <a href="/tags/闭包/" style="font-size: 10px;">闭包</a> <a href="/tags/面向对象/" style="font-size: 10.77px;">面向对象</a> <a href="/tags/面试/" style="font-size: 12.31px;">面试</a> <a href="/tags/高阶函数/" style="font-size: 10.77px;">高阶函数</a>
        </div>
    </div>
    <a href="javascript:;" class="sidebar-menu-box-close">×</a>
</div>
<div class="mobile-header-menu-nav" id="mobile-header-menu-nav">
    <div class="mobile-header-menu-container">
        <span class="title">Menus</span>
        <ul class="mobile-header-menu-navbar">
            
            <li>
                <a target="_blank" href="https://58fe.com">
                    <i class="fa fa-heart"></i><span>前端社区</span>
                </a>
            </li>
            
            <li>
                <a href="/">
                    <i class="fa fa-home"></i><span>主页</span>
                </a>
            </li>
            
            <li>
                <a href="/archives">
                    <i class="fa fa-archive"></i><span>归档</span>
                </a>
            </li>
            
        </ul>
    </div>
    <div class="mobile-header-tag-container">
        <span class="title">Tags</span>
        <div id="mobile-header-container-tags">
            <a href="/tags/CSS/" style="font-size: 13.08px;">CSS</a> <a href="/tags/Emmet/" style="font-size: 10px;">Emmet</a> <a href="/tags/HTTP/" style="font-size: 10.77px;">HTTP</a> <a href="/tags/Immutable/" style="font-size: 11.54px;">Immutable</a> <a href="/tags/MVC/" style="font-size: 10px;">MVC</a> <a href="/tags/Snippet/" style="font-size: 13.08px;">Snippet</a> <a href="/tags/Vue/" style="font-size: 13.08px;">Vue</a> <a href="/tags/ajax/" style="font-size: 11.54px;">ajax</a> <a href="/tags/angular/" style="font-size: 10px;">angular</a> <a href="/tags/api/" style="font-size: 12.31px;">api</a> <a href="/tags/atom/" style="font-size: 10px;">atom</a> <a href="/tags/axios/" style="font-size: 12.31px;">axios</a> <a href="/tags/bootstrap/" style="font-size: 10.77px;">bootstrap</a> <a href="/tags/canvas/" style="font-size: 11.54px;">canvas</a> <a href="/tags/cookie/" style="font-size: 10px;">cookie</a> <a href="/tags/css/" style="font-size: 16.15px;">css</a> <a href="/tags/dom/" style="font-size: 13.08px;">dom</a> <a href="/tags/dva/" style="font-size: 11.54px;">dva</a> <a href="/tags/echart/" style="font-size: 10px;">echart</a> <a href="/tags/editconfig/" style="font-size: 10px;">editconfig</a> <a href="/tags/es6/" style="font-size: 13.85px;">es6</a> <a href="/tags/eslint/" style="font-size: 10.77px;">eslint</a> <a href="/tags/fed-shared/" style="font-size: 11.54px;">fed-shared</a> <a href="/tags/fetch/" style="font-size: 10px;">fetch</a> <a href="/tags/flex/" style="font-size: 10px;">flex</a> <a href="/tags/front-end/" style="font-size: 10px;">front-end</a> <a href="/tags/git/" style="font-size: 10px;">git</a> <a href="/tags/github/" style="font-size: 12.31px;">github</a> <a href="/tags/gulp/" style="font-size: 10.77px;">gulp</a> <a href="/tags/hexo/" style="font-size: 10.77px;">hexo</a> <a href="/tags/hide/" style="font-size: 10.77px;">hide</a> <a href="/tags/html5/" style="font-size: 16.92px;">html5</a> <a href="/tags/http/" style="font-size: 10px;">http</a> <a href="/tags/hybrid/" style="font-size: 10px;">hybrid</a> <a href="/tags/javascript/" style="font-size: 20px;">javascript</a> <a href="/tags/jquery/" style="font-size: 17.69px;">jquery</a> <a href="/tags/js/" style="font-size: 10px;">js</a> <a href="/tags/js代码片段/" style="font-size: 12.31px;">js代码片段</a> <a href="/tags/mock/" style="font-size: 10px;">mock</a> <a href="/tags/ms/" style="font-size: 10px;">ms</a> <a href="/tags/mvvm/" style="font-size: 11.54px;">mvvm</a> <a href="/tags/nginx/" style="font-size: 12.31px;">nginx</a> <a href="/tags/node/" style="font-size: 13.85px;">node</a> <a href="/tags/npm/" style="font-size: 13.08px;">npm</a> <a href="/tags/promise/" style="font-size: 10px;">promise</a> <a href="/tags/react/" style="font-size: 19.23px;">react</a> <a href="/tags/redux/" style="font-size: 13.08px;">redux</a> <a href="/tags/sublime/" style="font-size: 15.38px;">sublime</a> <a href="/tags/svn/" style="font-size: 10.77px;">svn</a> <a href="/tags/taro/" style="font-size: 10px;">taro</a> <a href="/tags/todolist/" style="font-size: 10px;">todolist</a> <a href="/tags/video/" style="font-size: 10px;">video</a> <a href="/tags/vscode/" style="font-size: 11.54px;">vscode</a> <a href="/tags/vue/" style="font-size: 18.46px;">vue</a> <a href="/tags/vuex/" style="font-size: 10.77px;">vuex</a> <a href="/tags/webpack/" style="font-size: 14.62px;">webpack</a> <a href="/tags/webstorm/" style="font-size: 10px;">webstorm</a> <a href="/tags/xhtml/" style="font-size: 10px;">xhtml</a> <a href="/tags/中间件/" style="font-size: 10px;">中间件</a> <a href="/tags/事件/" style="font-size: 10px;">事件</a> <a href="/tags/事件流/" style="font-size: 10px;">事件流</a> <a href="/tags/优质文章分享/" style="font-size: 11.54px;">优质文章分享</a> <a href="/tags/作用域/" style="font-size: 10px;">作用域</a> <a href="/tags/前端优化/" style="font-size: 10.77px;">前端优化</a> <a href="/tags/前端基础/" style="font-size: 10px;">前端基础</a> <a href="/tags/前端自动化/" style="font-size: 10px;">前端自动化</a> <a href="/tags/前端规范/" style="font-size: 14.62px;">前端规范</a> <a href="/tags/原型链/" style="font-size: 10px;">原型链</a> <a href="/tags/小程序/" style="font-size: 13.85px;">小程序</a> <a href="/tags/居中/" style="font-size: 10px;">居中</a> <a href="/tags/异步回调/" style="font-size: 10px;">异步回调</a> <a href="/tags/微信开发/" style="font-size: 11.54px;">微信开发</a> <a href="/tags/快应用/" style="font-size: 10px;">快应用</a> <a href="/tags/性能优化/" style="font-size: 10px;">性能优化</a> <a href="/tags/排序算法/" style="font-size: 10px;">排序算法</a> <a href="/tags/最佳实践/" style="font-size: 10px;">最佳实践</a> <a href="/tags/正则表达式/" style="font-size: 10.77px;">正则表达式</a> <a href="/tags/测试/" style="font-size: 10px;">测试</a> <a href="/tags/知识点/" style="font-size: 11.54px;">知识点</a> <a href="/tags/移动端/" style="font-size: 13.08px;">移动端</a> <a href="/tags/组件化/" style="font-size: 10px;">组件化</a> <a href="/tags/继承/" style="font-size: 10.77px;">继承</a> <a href="/tags/缓存/" style="font-size: 10px;">缓存</a> <a href="/tags/读书笔记/" style="font-size: 10.77px;">读书笔记</a> <a href="/tags/跨域/" style="font-size: 11.54px;">跨域</a> <a href="/tags/踩过的坑/" style="font-size: 16.92px;">踩过的坑</a> <a href="/tags/适配/" style="font-size: 10px;">适配</a> <a href="/tags/速查表/" style="font-size: 10px;">速查表</a> <a href="/tags/部署/" style="font-size: 10.77px;">部署</a> <a href="/tags/闭包/" style="font-size: 10px;">闭包</a> <a href="/tags/面向对象/" style="font-size: 10.77px;">面向对象</a> <a href="/tags/面试/" style="font-size: 12.31px;">面试</a> <a href="/tags/高阶函数/" style="font-size: 10.77px;">高阶函数</a>
        </div>
    </div>
</div>
<div class="search-wrap">
    <span class="search-close">×</span>
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
            <i class="icon icon-lg icon-chevron-left"></i>
        </a>
        <input class="search-field" placeholder="Search..." id="keywords">
        <a id="search-submit" href="javascript:;">
            <i class="fa fa-search"></i>
        </a>
    <div class="search-container" id="search-container">
        <ul class="search-result" id="search-result">
        </ul>
    </div>
</div>

<div id="search-tpl">
    <li class="search-result-item">
        <a href="{url}" class="search-item-li">
            <span class="search-item-li-title" title="{title}">{title}</span>
        </a>
    </li>
</div>
<script src="//cdn.ru23.com/js/search.js"></script>
<script src="//cdn.ru23.com/js/main.js"></script>









<script src="//cdn.ru23.com/js/pop-img.js"></script>
<script>
  $(".article-entry p img").popImg();
</script>

  </div>


<script type="text/javascript" charset="utf-8" src="/js/lazyload-plugin/lazyload.intersectionObserver.min.js"></script></body></html>